import { ChangeDetectionStrategy, Component, ContentChild, ElementRef, EventEmitter, HostListener, Input, Output, TemplateRef, ViewChild } from '@angular/core';
import { VideoType } from '../../models/video-type.model';
import { animate, style, transition, trigger } from '@angular/animations';
import { skip } from 'rxjs';
import { SidenavMode } from '../../models/layout.model';
import { PanelType } from '../../models/panel.model';
import { Signal } from '../../models/signal.model';
import * as i0 from "@angular/core";
import * as i1 from "../../services/action/action.service";
import * as i2 from "../../services/openvidu/openvidu.service";
import * as i3 from "../../services/participant/participant.service";
import * as i4 from "../../services/logger/logger.service";
import * as i5 from "../../services/chat/chat.service";
import * as i6 from "../../services/config/openvidu-angular.config.service";
import * as i7 from "../../services/layout/layout.service";
import * as i8 from "../../services/panel/panel.service";
import * as i9 from "../../services/recording/recording.service";
import * as i10 from "../../services/translate/translate.service";
import * as i11 from "../../services/caption/caption.service";
import * as i12 from "../../services/platform/platform.service";
import * as i13 from "../../services/virtual-background/virtual-background.service";
import * as i14 from "@angular/common";
import * as i15 from "@angular/material/sidenav";
import * as i16 from "@angular/flex-layout/extended";
/**
 * @internal
 */
export class SessionComponent {
    constructor(actionService, openviduService, participantService, loggerSrv, chatService, libService, layoutService, panelService, recordingService, translateService, captionService, platformService, backgroundService, cd) {
        this.actionService = actionService;
        this.openviduService = openviduService;
        this.participantService = participantService;
        this.loggerSrv = loggerSrv;
        this.chatService = chatService;
        this.libService = libService;
        this.layoutService = layoutService;
        this.panelService = panelService;
        this.recordingService = recordingService;
        this.translateService = translateService;
        this.captionService = captionService;
        this.platformService = platformService;
        this.backgroundService = backgroundService;
        this.cd = cd;
        this.usedInPrejoinPage = false;
        this.onSessionCreated = new EventEmitter();
        this.onNodeCrashed = new EventEmitter();
        this.sidenavMode = SidenavMode.SIDE;
        this.preparing = true;
        this.SIDENAV_WIDTH_LIMIT_MODE = 790;
        this.log = this.loggerSrv.get('SessionComponent');
    }
    beforeunloadHandler() {
        this.leaveSession();
    }
    sizeChange() {
        this.layoutService.update();
    }
    set sidenavMenu(menu) {
        setTimeout(() => {
            if (menu) {
                this.sideMenu = menu;
                this.subscribeToTogglingMenu();
            }
        }, 0);
    }
    set videoContainer(container) {
        setTimeout(() => {
            if (container && !this.toolbarTemplate) {
                container.nativeElement.style.height = '100%';
                container.nativeElement.style.minHeight = '100%';
                this.layoutService.update();
            }
        }, 0);
    }
    set container(container) {
        setTimeout(() => {
            if (container) {
                this.drawer = container;
                this.drawer._contentMarginChanges.subscribe(() => {
                    setTimeout(() => {
                        this.stopUpdateLayoutInterval();
                        this.layoutService.update();
                        this.drawer.autosize = false;
                    }, 250);
                });
            }
        }, 0);
    }
    set layoutContainer(container) {
        setTimeout(async () => {
            if (container) {
                // Apply background from storage when layout container is in DOM
                await this.backgroundService.applyBackgroundFromStorage();
            }
        }, 0);
    }
    async ngOnInit() {
        if (!this.usedInPrejoinPage) {
            if (!this.openviduService.getScreenToken()) {
                // Hide screenshare button if screen token does not exist
                this.libService.screenshareButton.next(false);
            }
            this.session = this.openviduService.getWebcamSession();
            this.sessionScreen = this.openviduService.getScreenSession();
            this.subscribeToOpenViduException();
            this.subscribeToCaptionLanguage();
            this.subscribeToConnectionCreatedAndDestroyed();
            this.subscribeToStreamCreated();
            this.subscribeToStreamDestroyed();
            this.subscribeToStreamPropertyChange();
            this.subscribeToNicknameChanged();
            this.chatService.subscribeToChat();
            this.subscribeToReconnection();
            const recordingEnabled = this.libService.recordingButton.getValue() && this.libService.recordingActivity.getValue();
            if (recordingEnabled) {
                this.subscribeToRecordingEvents();
            }
            this.onSessionCreated.emit(this.session);
            await this.connectToSession();
            // ios devices appear with blank video. Muting and unmuting it fix this problem
            if (this.platformService.isIos() && this.participantService.isMyCameraActive()) {
                await this.openviduService.publishVideo(false);
                await this.openviduService.publishVideo(true);
            }
        }
        this.preparing = false;
        this.cd.markForCheck();
    }
    ngOnDestroy() {
        // Reconnecting session is received in Firefox
        // To avoid 'Connection lost' message uses session.off()
        this.session?.off('reconnecting');
        this.participantService.clear();
        this.session = null;
        this.sessionScreen = null;
        if (this.menuSubscription)
            this.menuSubscription.unsubscribe();
        if (this.layoutWidthSubscription)
            this.layoutWidthSubscription.unsubscribe();
    }
    leaveSession() {
        this.log.d('Leaving session...');
        this.openviduService.disconnect();
    }
    subscribeToTogglingMenu() {
        this.sideMenu.openedChange.subscribe(() => {
            this.stopUpdateLayoutInterval();
            this.layoutService.update();
        });
        this.sideMenu.openedStart.subscribe(() => {
            this.startUpdateLayoutInterval();
        });
        this.sideMenu.closedStart.subscribe(() => {
            this.startUpdateLayoutInterval();
        });
        this.menuSubscription = this.panelService.panelOpenedObs.pipe(skip(1)).subscribe((ev) => {
            if (this.sideMenu) {
                this.settingsPanelOpened = ev.opened && ev.type === PanelType.SETTINGS;
                if (this.sideMenu.opened && ev.opened) {
                    if (ev.type === PanelType.SETTINGS || ev.oldType === PanelType.SETTINGS) {
                        // Switch from SETTINGS to another panel and vice versa.
                        // As the SETTINGS panel will be bigger than others, the sidenav container must be updated.
                        // Setting autosize to 'true' allows update it.
                        this.drawer.autosize = true;
                        this.startUpdateLayoutInterval();
                    }
                }
                ev.opened ? this.sideMenu.open() : this.sideMenu.close();
            }
        });
    }
    subscribeToLayoutWidth() {
        this.layoutWidthSubscription = this.layoutService.layoutWidthObs.subscribe((width) => {
            this.sidenavMode = width <= this.SIDENAV_WIDTH_LIMIT_MODE ? SidenavMode.OVER : SidenavMode.SIDE;
        });
    }
    async connectToSession() {
        try {
            const webcamToken = this.openviduService.getWebcamToken();
            const screenToken = this.openviduService.getScreenToken();
            if (this.participantService.haveICameraAndScreenActive()) {
                await this.openviduService.connectSession(this.openviduService.getWebcamSession(), webcamToken);
                await this.openviduService.connectSession(this.openviduService.getScreenSession(), screenToken);
                await this.openviduService.publish(this.participantService.getMyCameraPublisher());
                await this.openviduService.publish(this.participantService.getMyScreenPublisher());
            }
            else if (this.participantService.isOnlyMyScreenActive()) {
                await this.openviduService.connectSession(this.openviduService.getScreenSession(), screenToken);
                await this.openviduService.publish(this.participantService.getMyScreenPublisher());
            }
            else {
                await this.openviduService.connectSession(this.openviduService.getWebcamSession(), webcamToken);
                await this.openviduService.publish(this.participantService.getMyCameraPublisher());
            }
        }
        catch (error) {
            // this._error.emit({ error: error.error, messgae: error.message, code: error.code, status: error.status });
            this.log.e('There was an error connecting to the session:', error.code, error.message);
            this.actionService.openDialog(this.translateService.translate('ERRORS.SESSION'), error?.error || error?.message || error);
        }
    }
    subscribeToOpenViduException() {
        this.session.on('exception', (event) => {
            this.log.e(event.name, event.message);
        });
    }
    subscribeToConnectionCreatedAndDestroyed() {
        this.session.on('connectionCreated', (event) => {
            const connectionId = event.connection?.connectionId;
            const nickname = this.participantService.getNicknameFromConnectionData(event.connection.data);
            const isRemoteConnection = !this.openviduService.isMyOwnConnection(connectionId);
            const isCameraConnection = !nickname?.includes(`_${VideoType.SCREEN}`);
            const data = event.connection?.data;
            if (isRemoteConnection && isCameraConnection) {
                // Adding participant when connection is created and it's not screen
                this.participantService.addRemoteConnection(connectionId, data, null);
                //Sending nicnkanme signal to new participants
                if (this.openviduService.needSendNicknameSignal()) {
                    const data = { clientData: this.participantService.getMyNickname() };
                    this.openviduService.sendSignal(Signal.NICKNAME_CHANGED, [event.connection], data);
                }
            }
        });
        this.session.on('connectionDestroyed', (event) => {
            const nickname = this.participantService.getNicknameFromConnectionData(event.connection.data);
            const isRemoteConnection = !this.openviduService.isMyOwnConnection(event.connection.connectionId);
            const isCameraConnection = !nickname?.includes(`_${VideoType.SCREEN}`);
            // Deleting participant when connection is destroyed
            if (isRemoteConnection && isCameraConnection) {
                this.participantService.removeConnectionByConnectionId(event.connection.connectionId);
            }
        });
    }
    subscribeToStreamCreated() {
        this.session.on('streamCreated', async (event) => {
            const connectionId = event.stream?.connection?.connectionId;
            const data = event.stream?.connection?.data;
            const isCameraType = this.participantService.getTypeConnectionData(data) === VideoType.CAMERA;
            const isRemoteConnection = !this.openviduService.isMyOwnConnection(connectionId);
            if (isRemoteConnection) {
                const subscriber = this.session.subscribe(event.stream, undefined);
                this.participantService.addRemoteConnection(connectionId, data, subscriber);
                // this.oVSessionService.sendNicknameSignal(event.stream.connection);
                if (this.captionService.areCaptionsEnabled() && isCameraType) {
                    // Only subscribe to STT when stream is CAMERA type and it is a remote stream
                    try {
                        await this.session.subscribeToSpeechToText(event.stream, this.captionService.getLangSelected().ISO);
                    }
                    catch (error) {
                        this.log.e('Error subscribing from STT: ', error);
                    }
                }
            }
        });
    }
    subscribeToStreamDestroyed() {
        this.session.on('streamDestroyed', async (event) => {
            const connectionId = event.stream.connection.connectionId;
            const data = event.stream?.connection?.data;
            const isRemoteConnection = !this.openviduService.isMyOwnConnection(connectionId);
            const isCameraType = this.participantService.getTypeConnectionData(data) === VideoType.CAMERA;
            this.participantService.removeConnectionByConnectionId(connectionId);
            if (isRemoteConnection) {
                if (this.captionService.areCaptionsEnabled() && isCameraType) {
                    try {
                        await this.session.unsubscribeFromSpeechToText(event.stream);
                    }
                    catch (error) {
                        this.log.e('Error unsubscribing from STT: ', error);
                    }
                }
            }
        });
    }
    subscribeToCaptionLanguage() {
        this.captionLanguageSubscription = this.captionService.captionLangObs.subscribe(async (lang) => {
            if (this.captionService.areCaptionsEnabled()) {
                // Unsubscribe all streams from speech to text and re-subscribe with new language
                this.log.d('Re-subscribe from STT because of language changed to ', lang.ISO);
                for (const participant of this.participantService.getRemoteParticipants()) {
                    const streamManager = participant.getCameraConnection()?.streamManager;
                    if (!!streamManager?.stream) {
                        try {
                            await this.session.unsubscribeFromSpeechToText(streamManager.stream);
                            await this.session.subscribeToSpeechToText(streamManager.stream, lang.ISO);
                        }
                        catch (error) {
                            this.log.e('Error re-subscribing to STT: ', error);
                        }
                    }
                }
            }
        });
    }
    subscribeToStreamPropertyChange() {
        this.session.on('streamPropertyChanged', (event) => {
            const connectionId = event.stream.connection.connectionId;
            const isRemoteConnection = !this.openviduService.isMyOwnConnection(connectionId);
            if (isRemoteConnection) {
                this.participantService.updateRemoteParticipants();
            }
        });
    }
    subscribeToNicknameChanged() {
        this.session.on(`signal:${Signal.NICKNAME_CHANGED}`, (event) => {
            const connectionId = event.from.connectionId;
            const isRemoteConnection = !this.openviduService.isMyOwnConnection(connectionId);
            if (isRemoteConnection) {
                const nickname = this.participantService.getNicknameFromConnectionData(event.data);
                this.participantService.setRemoteNickname(connectionId, nickname);
            }
        });
    }
    subscribeToReconnection() {
        this.session.on('reconnecting', () => {
            this.log.w('Connection lost: Reconnecting');
            this.actionService.openDialog(this.translateService.translate('ERRORS.CONNECTION'), this.translateService.translate('ERRORS.RECONNECT'), false);
        });
        this.session.on('reconnected', () => {
            this.log.w('Connection lost: Reconnected');
            this.actionService.closeDialog();
        });
        this.session.on('sessionDisconnected', (event) => {
            if (event.reason === 'nodeCrashed') {
                this.actionService.openDialog(this.translateService.translate('ERRORS.CONNECTION'), this.translateService.translate('ERRORS.RECONNECT'), false);
                this.onNodeCrashed.emit();
            }
            else if (event.reason === 'networkDisconnect') {
                this.actionService.closeDialog();
                this.leaveSession();
            }
        });
    }
    subscribeToRecordingEvents() {
        this.session.on('recordingStarted', (event) => {
            this.recordingService.startRecording(event);
        });
        this.session.on('recordingStopped', (event) => {
            this.recordingService.stopRecording(event);
        });
    }
    startUpdateLayoutInterval() {
        this.updateLayoutInterval = setInterval(() => {
            this.layoutService.update();
        }, 50);
    }
    stopUpdateLayoutInterval() {
        if (this.updateLayoutInterval) {
            clearInterval(this.updateLayoutInterval);
        }
    }
}
SessionComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: SessionComponent, deps: [{ token: i1.ActionService }, { token: i2.OpenViduService }, { token: i3.ParticipantService }, { token: i4.LoggerService }, { token: i5.ChatService }, { token: i6.OpenViduAngularConfigService }, { token: i7.LayoutService }, { token: i8.PanelService }, { token: i9.RecordingService }, { token: i10.TranslateService }, { token: i11.CaptionService }, { token: i12.PlatformService }, { token: i13.VirtualBackgroundService }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
SessionComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.8", type: SessionComponent, selector: "ov-session", inputs: { usedInPrejoinPage: "usedInPrejoinPage" }, outputs: { onSessionCreated: "onSessionCreated", onNodeCrashed: "onNodeCrashed" }, host: { listeners: { "window:beforeunload": "beforeunloadHandler()", "window:resize": "sizeChange()" } }, queries: [{ propertyName: "toolbarTemplate", first: true, predicate: ["toolbar"], descendants: true, read: TemplateRef }, { propertyName: "panelTemplate", first: true, predicate: ["panel"], descendants: true, read: TemplateRef }, { propertyName: "layoutTemplate", first: true, predicate: ["layout"], descendants: true, read: TemplateRef }], viewQueries: [{ propertyName: "sidenavMenu", first: true, predicate: ["sidenav"], descendants: true }, { propertyName: "videoContainer", first: true, predicate: ["videoContainer"], descendants: true, read: ElementRef }, { propertyName: "container", first: true, predicate: ["container"], descendants: true }, { propertyName: "layoutContainer", first: true, predicate: ["layoutContainer"], descendants: true }], ngImport: i0, template: "<div id=\"session-container\" *ngIf=\"!preparing\" @sessionAnimation>\n\t<mat-sidenav-container #container #videoContainer class=\"sidenav-container\">\n\t\t<mat-sidenav\n\t\t\t#sidenav\n\t\t\tmode=\"{{ sidenavMode }}\"\n\t\t\tposition=\"end\"\n\t\t\tclass=\"sidenav-menu\"\n\t\t\t[ngClass]=\"{big: settingsPanelOpened}\"\n\t\t\tfixedInViewport=\"true\"\n\t\t\tfixedTopGap=\"0\"\n\t\t\tfixedBottomGap=\"0\"\n\t\t>\n\t\t\t<ng-container *ngTemplateOutlet=\"panelTemplate\"></ng-container>\n\t\t</mat-sidenav>\n\n\t\t<mat-sidenav-content class=\"sidenav-main\">\n\t\t\t<div id=\"layout-container\"  #layoutContainer>\n\t\t\t\t<ng-container *ngTemplateOutlet=\"layoutTemplate\"></ng-container>\n\t\t\t</div>\n\t\t</mat-sidenav-content>\n\t</mat-sidenav-container>\n\n\t<div id=\"footer-container\" *ngIf=\"toolbarTemplate\">\n\t\t<ng-container *ngTemplateOutlet=\"toolbarTemplate\"></ng-container>\n\t</div>\n</div>\n", styles: ["#session-container{background-color:var(--ov-primary-color);height:100%}.sidenav-container{position:relative;height:calc(100% - 70px);min-height:calc(100% - 70px);padding-top:0;width:100%;overflow:hidden}.sidenav-menu{display:flex;align-items:center;justify-content:center;width:380px;background-color:var(--ov-primary-color);border-left:none;position:absolute;z-index:1}.big{width:650px;max-width:100%}.mat-drawer.mat-drawer-side{z-index:0!important}.sidenav-main{height:100%;overflow:hidden;min-height:-webkit-fill-available;min-height:-moz-available}#layout-container{height:inherit;width:inherit}.mat-drawer-container{background-color:var(--ov-primary-color)}#toolbar-container,#footer-container{background-color:var(--ov-primary-color);width:100%;height:70px}#footer{color:#fff;height:25px;background-color:#333;padding:0 14px 0 0;position:absolute;bottom:0;left:0;z-index:999999}.reconnecting-container{width:100%;height:100%;z-index:1000;background-color:#000;opacity:80%;position:absolute}@media only screen and (max-width: 600px){#session-container{width:100%}}::ng-deep .mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:1px!important}::ng-deep .mat-input-element{caret-color:#000}::ng-deep .mat-primary .mat-option.mat-selected:not(.mat-option-disabled){color:#000}::ng-deep .mat-form-field-label{color:var(--ov-panel-text-color)!important}::ng-deep .mat-form-field.mat-focused .mat-form-field-ripple{background-color:var(--ov-panel-text-color)!important}::ng-deep .mat-drawer{background-color:transparent!important}\n"], dependencies: [{ kind: "directive", type: i14.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i14.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i14.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i15.MatSidenav, selector: "mat-sidenav", inputs: ["fixedInViewport", "fixedTopGap", "fixedBottomGap"], exportAs: ["matSidenav"] }, { kind: "component", type: i15.MatSidenavContainer, selector: "mat-sidenav-container", exportAs: ["matSidenavContainer"] }, { kind: "component", type: i15.MatSidenavContent, selector: "mat-sidenav-content" }, { kind: "directive", type: i16.DefaultClassDirective, selector: "  [ngClass], [ngClass.xs], [ngClass.sm], [ngClass.md], [ngClass.lg], [ngClass.xl],  [ngClass.lt-sm], [ngClass.lt-md], [ngClass.lt-lg], [ngClass.lt-xl],  [ngClass.gt-xs], [ngClass.gt-sm], [ngClass.gt-md], [ngClass.gt-lg]", inputs: ["ngClass", "ngClass.xs", "ngClass.sm", "ngClass.md", "ngClass.lg", "ngClass.xl", "ngClass.lt-sm", "ngClass.lt-md", "ngClass.lt-lg", "ngClass.lt-xl", "ngClass.gt-xs", "ngClass.gt-sm", "ngClass.gt-md", "ngClass.gt-lg"] }], animations: [trigger('sessionAnimation', [transition(':enter', [style({ opacity: 0 }), animate('50ms', style({ opacity: 1 }))])])], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: SessionComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ov-session', animations: [trigger('sessionAnimation', [transition(':enter', [style({ opacity: 0 }), animate('50ms', style({ opacity: 1 }))])])], changeDetection: ChangeDetectionStrategy.OnPush, template: "<div id=\"session-container\" *ngIf=\"!preparing\" @sessionAnimation>\n\t<mat-sidenav-container #container #videoContainer class=\"sidenav-container\">\n\t\t<mat-sidenav\n\t\t\t#sidenav\n\t\t\tmode=\"{{ sidenavMode }}\"\n\t\t\tposition=\"end\"\n\t\t\tclass=\"sidenav-menu\"\n\t\t\t[ngClass]=\"{big: settingsPanelOpened}\"\n\t\t\tfixedInViewport=\"true\"\n\t\t\tfixedTopGap=\"0\"\n\t\t\tfixedBottomGap=\"0\"\n\t\t>\n\t\t\t<ng-container *ngTemplateOutlet=\"panelTemplate\"></ng-container>\n\t\t</mat-sidenav>\n\n\t\t<mat-sidenav-content class=\"sidenav-main\">\n\t\t\t<div id=\"layout-container\"  #layoutContainer>\n\t\t\t\t<ng-container *ngTemplateOutlet=\"layoutTemplate\"></ng-container>\n\t\t\t</div>\n\t\t</mat-sidenav-content>\n\t</mat-sidenav-container>\n\n\t<div id=\"footer-container\" *ngIf=\"toolbarTemplate\">\n\t\t<ng-container *ngTemplateOutlet=\"toolbarTemplate\"></ng-container>\n\t</div>\n</div>\n", styles: ["#session-container{background-color:var(--ov-primary-color);height:100%}.sidenav-container{position:relative;height:calc(100% - 70px);min-height:calc(100% - 70px);padding-top:0;width:100%;overflow:hidden}.sidenav-menu{display:flex;align-items:center;justify-content:center;width:380px;background-color:var(--ov-primary-color);border-left:none;position:absolute;z-index:1}.big{width:650px;max-width:100%}.mat-drawer.mat-drawer-side{z-index:0!important}.sidenav-main{height:100%;overflow:hidden;min-height:-webkit-fill-available;min-height:-moz-available}#layout-container{height:inherit;width:inherit}.mat-drawer-container{background-color:var(--ov-primary-color)}#toolbar-container,#footer-container{background-color:var(--ov-primary-color);width:100%;height:70px}#footer{color:#fff;height:25px;background-color:#333;padding:0 14px 0 0;position:absolute;bottom:0;left:0;z-index:999999}.reconnecting-container{width:100%;height:100%;z-index:1000;background-color:#000;opacity:80%;position:absolute}@media only screen and (max-width: 600px){#session-container{width:100%}}::ng-deep .mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:1px!important}::ng-deep .mat-input-element{caret-color:#000}::ng-deep .mat-primary .mat-option.mat-selected:not(.mat-option-disabled){color:#000}::ng-deep .mat-form-field-label{color:var(--ov-panel-text-color)!important}::ng-deep .mat-form-field.mat-focused .mat-form-field-ripple{background-color:var(--ov-panel-text-color)!important}::ng-deep .mat-drawer{background-color:transparent!important}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.ActionService }, { type: i2.OpenViduService }, { type: i3.ParticipantService }, { type: i4.LoggerService }, { type: i5.ChatService }, { type: i6.OpenViduAngularConfigService }, { type: i7.LayoutService }, { type: i8.PanelService }, { type: i9.RecordingService }, { type: i10.TranslateService }, { type: i11.CaptionService }, { type: i12.PlatformService }, { type: i13.VirtualBackgroundService }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { toolbarTemplate: [{
                type: ContentChild,
                args: ['toolbar', { read: TemplateRef }]
            }], panelTemplate: [{
                type: ContentChild,
                args: ['panel', { read: TemplateRef }]
            }], layoutTemplate: [{
                type: ContentChild,
                args: ['layout', { read: TemplateRef }]
            }], usedInPrejoinPage: [{
                type: Input
            }], onSessionCreated: [{
                type: Output
            }], onNodeCrashed: [{
                type: Output
            }], beforeunloadHandler: [{
                type: HostListener,
                args: ['window:beforeunload']
            }], sizeChange: [{
                type: HostListener,
                args: ['window:resize']
            }], sidenavMenu: [{
                type: ViewChild,
                args: ['sidenav']
            }], videoContainer: [{
                type: ViewChild,
                args: ['videoContainer', { static: false, read: ElementRef }]
            }], container: [{
                type: ViewChild,
                args: ['container']
            }], layoutContainer: [{
                type: ViewChild,
                args: ['layoutContainer']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Vzc2lvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9vcGVudmlkdS1hbmd1bGFyL3NyYy9saWIvY29tcG9uZW50cy9zZXNzaW9uL3Nlc3Npb24uY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvb3BlbnZpZHUtYW5ndWxhci9zcmMvbGliL2NvbXBvbmVudHMvc2Vzc2lvbi9zZXNzaW9uLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTix1QkFBdUIsRUFFdkIsU0FBUyxFQUNULFlBQVksRUFDWixVQUFVLEVBQ1YsWUFBWSxFQUNaLFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxFQUNOLFdBQVcsRUFDWCxTQUFTLEVBQ1QsTUFBTSxlQUFlLENBQUM7QUFhdkIsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBRTFELE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUUxRSxPQUFPLEVBQUUsSUFBSSxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUMxQyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDeEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZW5EOztHQUVHO0FBU0gsTUFBTSxPQUFPLGdCQUFnQjtJQThCNUIsWUFDVyxhQUE0QixFQUM1QixlQUFnQyxFQUNoQyxrQkFBc0MsRUFDdEMsU0FBd0IsRUFDeEIsV0FBd0IsRUFDMUIsVUFBd0MsRUFDdEMsYUFBNEIsRUFDNUIsWUFBMEIsRUFDNUIsZ0JBQWtDLEVBQ2xDLGdCQUFrQyxFQUNsQyxjQUE4QixFQUM5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O2tCQVA1QixTQUFTOytCQUNDLFlBQVksY0FHVixDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxtQkFDakgsdUJBQXVCLENBQUMsTUFBTTsrZkFHQyxlQUFlO3NCQUE5RCxZQUFZO3VCQUFDLFNBQVMsRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUU7Z0JBQ0EsYUFBYTtzQkFBMUQsWUFBWTt1QkFBQyxPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFO2dCQUNHLGNBQWM7c0JBQTVELFlBQVk7dUJBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTtnQkFFcEMsaUJBQWlCO3NCQUF6QixLQUFLO2dCQUNJLGdCQUFnQjtzQkFBekIsTUFBTTtnQkFFRyxhQUFhO3NCQUF0QixNQUFNO2dCQTBDUCxtQkFBbUI7c0JBRGxCLFlBQVk7dUJBQUMscUJBQXFCO2dCQU1uQyxVQUFVO3NCQURULFlBQVk7dUJBQUMsZUFBZTtnQkFNekIsV0FBVztzQkFEZCxTQUFTO3VCQUFDLFNBQVM7Z0JBV2hCLGNBQWM7c0JBRGpCLFNBQVM7dUJBQUMsZ0JBQWdCLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUU7Z0JBWTVELFNBQVM7c0JBRFosU0FBUzt1QkFBQyxXQUFXO2dCQWlCbEIsZUFBZTtzQkFEbEIsU0FBUzt1QkFBQyxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuXHRDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcblx0Q2hhbmdlRGV0ZWN0b3JSZWYsXG5cdENvbXBvbmVudCxcblx0Q29udGVudENoaWxkLFxuXHRFbGVtZW50UmVmLFxuXHRFdmVudEVtaXR0ZXIsXG5cdEhvc3RMaXN0ZW5lcixcblx0SW5wdXQsXG5cdE9uRGVzdHJveSxcblx0T25Jbml0LFxuXHRPdXRwdXQsXG5cdFRlbXBsYXRlUmVmLFxuXHRWaWV3Q2hpbGRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuXHRDb25uZWN0aW9uRXZlbnQsXG5cdEV4Y2VwdGlvbkV2ZW50LFxuXHRSZWNvcmRpbmdFdmVudCxcblx0U2Vzc2lvbixcblx0U2Vzc2lvbkRpc2Nvbm5lY3RlZEV2ZW50LFxuXHRTdHJlYW1FdmVudCxcblx0U3RyZWFtUHJvcGVydHlDaGFuZ2VkRXZlbnQsXG5cdFN1YnNjcmliZXJcbn0gZnJvbSAnb3BlbnZpZHUtYnJvd3Nlcic7XG5cbmltcG9ydCB7IElMb2dnZXIgfSBmcm9tICcuLi8uLi9tb2RlbHMvbG9nZ2VyLm1vZGVsJztcbmltcG9ydCB7IFZpZGVvVHlwZSB9IGZyb20gJy4uLy4uL21vZGVscy92aWRlby10eXBlLm1vZGVsJztcblxuaW1wb3J0IHsgYW5pbWF0ZSwgc3R5bGUsIHRyYW5zaXRpb24sIHRyaWdnZXIgfSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IE1hdERyYXdlckNvbnRhaW5lciwgTWF0U2lkZW5hdiB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL3NpZGVuYXYnO1xuaW1wb3J0IHsgc2tpcCwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBTaWRlbmF2TW9kZSB9IGZyb20gJy4uLy4uL21vZGVscy9sYXlvdXQubW9kZWwnO1xuaW1wb3J0IHsgUGFuZWxUeXBlIH0gZnJvbSAnLi4vLi4vbW9kZWxzL3BhbmVsLm1vZGVsJztcbmltcG9ydCB7IFNpZ25hbCB9IGZyb20gJy4uLy4uL21vZGVscy9zaWduYWwubW9kZWwnO1xuaW1wb3J0IHsgQWN0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FjdGlvbi9hY3Rpb24uc2VydmljZSc7XG5pbXBvcnQgeyBDYXB0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2NhcHRpb24vY2FwdGlvbi5zZXJ2aWNlJztcbmltcG9ydCB7IENoYXRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvY2hhdC9jaGF0LnNlcnZpY2UnO1xuaW1wb3J0IHsgT3BlblZpZHVBbmd1bGFyQ29uZmlnU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2NvbmZpZy9vcGVudmlkdS1hbmd1bGFyLmNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7IExheW91dFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9sYXlvdXQvbGF5b3V0LnNlcnZpY2UnO1xuaW1wb3J0IHsgTG9nZ2VyU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2xvZ2dlci9sb2dnZXIuc2VydmljZSc7XG5pbXBvcnQgeyBPcGVuVmlkdVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9vcGVudmlkdS9vcGVudmlkdS5zZXJ2aWNlJztcbmltcG9ydCB7IFBhbmVsRXZlbnQsIFBhbmVsU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3BhbmVsL3BhbmVsLnNlcnZpY2UnO1xuaW1wb3J0IHsgUGFydGljaXBhbnRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcGFydGljaXBhbnQvcGFydGljaXBhbnQuc2VydmljZSc7XG5pbXBvcnQgeyBQbGF0Zm9ybVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9wbGF0Zm9ybS9wbGF0Zm9ybS5zZXJ2aWNlJztcbmltcG9ydCB7IFJlY29yZGluZ1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9yZWNvcmRpbmcvcmVjb3JkaW5nLnNlcnZpY2UnO1xuaW1wb3J0IHsgVHJhbnNsYXRlU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3RyYW5zbGF0ZS90cmFuc2xhdGUuc2VydmljZSc7XG5pbXBvcnQgeyBWaXJ0dWFsQmFja2dyb3VuZFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy92aXJ0dWFsLWJhY2tncm91bmQvdmlydHVhbC1iYWNrZ3JvdW5kLnNlcnZpY2UnO1xuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogJ292LXNlc3Npb24nLFxuXHR0ZW1wbGF0ZVVybDogJy4vc2Vzc2lvbi5jb21wb25lbnQuaHRtbCcsXG5cdHN0eWxlVXJsczogWycuL3Nlc3Npb24uY29tcG9uZW50LmNzcyddLFxuXHRhbmltYXRpb25zOiBbdHJpZ2dlcignc2Vzc2lvbkFuaW1hdGlvbicsIFt0cmFuc2l0aW9uKCc6ZW50ZXInLCBbc3R5bGUoeyBvcGFjaXR5OiAwIH0pLCBhbmltYXRlKCc1MG1zJywgc3R5bGUoeyBvcGFjaXR5OiAxIH0pKV0pXSldLFxuXHRjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBTZXNzaW9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuXHRAQ29udGVudENoaWxkKCd0b29sYmFyJywgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSB0b29sYmFyVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG5cdEBDb250ZW50Q2hpbGQoJ3BhbmVsJywgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBwYW5lbFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXHRAQ29udGVudENoaWxkKCdsYXlvdXQnLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pIGxheW91dFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG5cdEBJbnB1dCgpIHVzZWRJblByZWpvaW5QYWdlID0gZmFsc2U7XG5cdEBPdXRwdXQoKSBvblNlc3Npb25DcmVhdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cblx0QE91dHB1dCgpIG9uTm9kZUNyYXNoZWQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuXHRzZXNzaW9uOiBTZXNzaW9uO1xuXHRzZXNzaW9uU2NyZWVuOiBTZXNzaW9uO1xuXG5cdHNpZGVNZW51OiBNYXRTaWRlbmF2O1xuXG5cdHNpZGVuYXZNb2RlOiBTaWRlbmF2TW9kZSA9IFNpZGVuYXZNb2RlLlNJREU7XG5cdHNldHRpbmdzUGFuZWxPcGVuZWQ6IGJvb2xlYW47XG5cdGRyYXdlcjogTWF0RHJhd2VyQ29udGFpbmVyO1xuXHRwcmVwYXJpbmc6IGJvb2xlYW4gPSB0cnVlO1xuXG5cdHByb3RlY3RlZCByZWFkb25seSBTSURFTkFWX1dJRFRIX0xJTUlUX01PREUgPSA3OTA7XG5cblx0cHJvdGVjdGVkIG1lbnVTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcblx0cHJvdGVjdGVkIGxheW91dFdpZHRoU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cblx0cHJvdGVjdGVkIHVwZGF0ZUxheW91dEludGVydmFsOiBOb2RlSlMuVGltZXI7XG5cdHByaXZhdGUgY2FwdGlvbkxhbmd1YWdlU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cblx0cHJvdGVjdGVkIGxvZzogSUxvZ2dlcjtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcm90ZWN0ZWQgYWN0aW9uU2VydmljZTogQWN0aW9uU2VydmljZSxcblx0XHRwcm90ZWN0ZWQgb3BlbnZpZHVTZXJ2aWNlOiBPcGVuVmlkdVNlcnZpY2UsXG5cdFx0cHJvdGVjdGVkIHBhcnRpY2lwYW50U2VydmljZTogUGFydGljaXBhbnRTZXJ2aWNlLFxuXHRcdHByb3RlY3RlZCBsb2dnZXJTcnY6IExvZ2dlclNlcnZpY2UsXG5cdFx0cHJvdGVjdGVkIGNoYXRTZXJ2aWNlOiBDaGF0U2VydmljZSxcblx0XHRwcml2YXRlIGxpYlNlcnZpY2U6IE9wZW5WaWR1QW5ndWxhckNvbmZpZ1NlcnZpY2UsXG5cdFx0cHJvdGVjdGVkIGxheW91dFNlcnZpY2U6IExheW91dFNlcnZpY2UsXG5cdFx0cHJvdGVjdGVkIHBhbmVsU2VydmljZTogUGFuZWxTZXJ2aWNlLFxuXHRcdHByaXZhdGUgcmVjb3JkaW5nU2VydmljZTogUmVjb3JkaW5nU2VydmljZSxcblx0XHRwcml2YXRlIHRyYW5zbGF0ZVNlcnZpY2U6IFRyYW5zbGF0ZVNlcnZpY2UsXG5cdFx0cHJpdmF0ZSBjYXB0aW9uU2VydmljZTogQ2FwdGlvblNlcnZpY2UsXG5cdFx0cHJpdmF0ZSBwbGF0Zm9ybVNlcnZpY2U6IFBsYXRmb3JtU2VydmljZSxcblx0XHRwcml2YXRlIGJhY2tncm91bmRTZXJ2aWNlOiBWaXJ0dWFsQmFja2dyb3VuZFNlcnZpY2UsXG5cdFx0cHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWZcblx0KSB7XG5cdFx0dGhpcy5sb2cgPSB0aGlzLmxvZ2dlclNydi5nZXQoJ1Nlc3Npb25Db21wb25lbnQnKTtcblx0fVxuXG5cdEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpiZWZvcmV1bmxvYWQnKVxuXHRiZWZvcmV1bmxvYWRIYW5kbGVyKCkge1xuXHRcdHRoaXMubGVhdmVTZXNzaW9uKCk7XG5cdH1cblxuXHRASG9zdExpc3RlbmVyKCd3aW5kb3c6cmVzaXplJylcblx0c2l6ZUNoYW5nZSgpIHtcblx0XHR0aGlzLmxheW91dFNlcnZpY2UudXBkYXRlKCk7XG5cdH1cblxuXHRAVmlld0NoaWxkKCdzaWRlbmF2Jylcblx0c2V0IHNpZGVuYXZNZW51KG1lbnU6IE1hdFNpZGVuYXYpIHtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmIChtZW51KSB7XG5cdFx0XHRcdHRoaXMuc2lkZU1lbnUgPSBtZW51O1xuXHRcdFx0XHR0aGlzLnN1YnNjcmliZVRvVG9nZ2xpbmdNZW51KCk7XG5cdFx0XHR9XG5cdFx0fSwgMCk7XG5cdH1cblxuXHRAVmlld0NoaWxkKCd2aWRlb0NvbnRhaW5lcicsIHsgc3RhdGljOiBmYWxzZSwgcmVhZDogRWxlbWVudFJlZiB9KVxuXHRzZXQgdmlkZW9Db250YWluZXIoY29udGFpbmVyOiBFbGVtZW50UmVmKSB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAoY29udGFpbmVyICYmICF0aGlzLnRvb2xiYXJUZW1wbGF0ZSkge1xuXHRcdFx0XHRjb250YWluZXIubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7XG5cdFx0XHRcdGNvbnRhaW5lci5uYXRpdmVFbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9ICcxMDAlJztcblx0XHRcdFx0dGhpcy5sYXlvdXRTZXJ2aWNlLnVwZGF0ZSgpO1xuXHRcdFx0fVxuXHRcdH0sIDApO1xuXHR9XG5cblx0QFZpZXdDaGlsZCgnY29udGFpbmVyJylcblx0c2V0IGNvbnRhaW5lcihjb250YWluZXI6IE1hdERyYXdlckNvbnRhaW5lcikge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKGNvbnRhaW5lcikge1xuXHRcdFx0XHR0aGlzLmRyYXdlciA9IGNvbnRhaW5lcjtcblx0XHRcdFx0dGhpcy5kcmF3ZXIuX2NvbnRlbnRNYXJnaW5DaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnN0b3BVcGRhdGVMYXlvdXRJbnRlcnZhbCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5sYXlvdXRTZXJ2aWNlLnVwZGF0ZSgpO1xuXHRcdFx0XHRcdFx0dGhpcy5kcmF3ZXIuYXV0b3NpemUgPSBmYWxzZTtcblx0XHRcdFx0XHR9LCAyNTApO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9LCAwKTtcblx0fVxuXG5cdEBWaWV3Q2hpbGQoJ2xheW91dENvbnRhaW5lcicpXG5cdHNldCBsYXlvdXRDb250YWluZXIoY29udGFpbmVyOiBFbGVtZW50UmVmKSB7XG5cdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0XHRcdC8vIEFwcGx5IGJhY2tncm91bmQgZnJvbSBzdG9yYWdlIHdoZW4gbGF5b3V0IGNvbnRhaW5lciBpcyBpbiBET01cblx0XHRcdFx0YXdhaXQgdGhpcy5iYWNrZ3JvdW5kU2VydmljZS5hcHBseUJhY2tncm91bmRGcm9tU3RvcmFnZSgpO1xuXHRcdFx0fVxuXHRcdH0sIDApO1xuXHR9XG5cblx0YXN5bmMgbmdPbkluaXQoKSB7XG5cdFx0aWYgKCF0aGlzLnVzZWRJblByZWpvaW5QYWdlKSB7XG5cdFx0XHRpZiAoIXRoaXMub3BlbnZpZHVTZXJ2aWNlLmdldFNjcmVlblRva2VuKCkpIHtcblx0XHRcdFx0Ly8gSGlkZSBzY3JlZW5zaGFyZSBidXR0b24gaWYgc2NyZWVuIHRva2VuIGRvZXMgbm90IGV4aXN0XG5cdFx0XHRcdHRoaXMubGliU2VydmljZS5zY3JlZW5zaGFyZUJ1dHRvbi5uZXh0KGZhbHNlKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuc2Vzc2lvbiA9IHRoaXMub3BlbnZpZHVTZXJ2aWNlLmdldFdlYmNhbVNlc3Npb24oKTtcblx0XHRcdHRoaXMuc2Vzc2lvblNjcmVlbiA9IHRoaXMub3BlbnZpZHVTZXJ2aWNlLmdldFNjcmVlblNlc3Npb24oKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlVG9PcGVuVmlkdUV4Y2VwdGlvbigpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmVUb0NhcHRpb25MYW5ndWFnZSgpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmVUb0Nvbm5lY3Rpb25DcmVhdGVkQW5kRGVzdHJveWVkKCk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZVRvU3RyZWFtQ3JlYXRlZCgpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmVUb1N0cmVhbURlc3Ryb3llZCgpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmVUb1N0cmVhbVByb3BlcnR5Q2hhbmdlKCk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZVRvTmlja25hbWVDaGFuZ2VkKCk7XG5cdFx0XHR0aGlzLmNoYXRTZXJ2aWNlLnN1YnNjcmliZVRvQ2hhdCgpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmVUb1JlY29ubmVjdGlvbigpO1xuXHRcdFx0Y29uc3QgcmVjb3JkaW5nRW5hYmxlZCA9IHRoaXMubGliU2VydmljZS5yZWNvcmRpbmdCdXR0b24uZ2V0VmFsdWUoKSAmJiB0aGlzLmxpYlNlcnZpY2UucmVjb3JkaW5nQWN0aXZpdHkuZ2V0VmFsdWUoKTtcblx0XHRcdGlmIChyZWNvcmRpbmdFbmFibGVkKSB7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlVG9SZWNvcmRpbmdFdmVudHMoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMub25TZXNzaW9uQ3JlYXRlZC5lbWl0KHRoaXMuc2Vzc2lvbik7XG5cblx0XHRcdGF3YWl0IHRoaXMuY29ubmVjdFRvU2Vzc2lvbigpO1xuXHRcdFx0Ly8gaW9zIGRldmljZXMgYXBwZWFyIHdpdGggYmxhbmsgdmlkZW8uIE11dGluZyBhbmQgdW5tdXRpbmcgaXQgZml4IHRoaXMgcHJvYmxlbVxuXHRcdFx0aWYgKHRoaXMucGxhdGZvcm1TZXJ2aWNlLmlzSW9zKCkgJiYgdGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UuaXNNeUNhbWVyYUFjdGl2ZSgpKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMub3BlbnZpZHVTZXJ2aWNlLnB1Ymxpc2hWaWRlbyhmYWxzZSk7XG5cdFx0XHRcdGF3YWl0IHRoaXMub3BlbnZpZHVTZXJ2aWNlLnB1Ymxpc2hWaWRlbyh0cnVlKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5wcmVwYXJpbmcgPSBmYWxzZTtcblx0XHR0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xuXHR9XG5cblx0bmdPbkRlc3Ryb3koKSB7XG5cdFx0Ly8gUmVjb25uZWN0aW5nIHNlc3Npb24gaXMgcmVjZWl2ZWQgaW4gRmlyZWZveFxuXHRcdC8vIFRvIGF2b2lkICdDb25uZWN0aW9uIGxvc3QnIG1lc3NhZ2UgdXNlcyBzZXNzaW9uLm9mZigpXG5cdFx0dGhpcy5zZXNzaW9uPy5vZmYoJ3JlY29ubmVjdGluZycpO1xuXHRcdHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmNsZWFyKCk7XG5cdFx0dGhpcy5zZXNzaW9uID0gbnVsbDtcblx0XHR0aGlzLnNlc3Npb25TY3JlZW4gPSBudWxsO1xuXHRcdGlmICh0aGlzLm1lbnVTdWJzY3JpcHRpb24pIHRoaXMubWVudVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuXHRcdGlmICh0aGlzLmxheW91dFdpZHRoU3Vic2NyaXB0aW9uKSB0aGlzLmxheW91dFdpZHRoU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG5cdH1cblxuXHRsZWF2ZVNlc3Npb24oKSB7XG5cdFx0dGhpcy5sb2cuZCgnTGVhdmluZyBzZXNzaW9uLi4uJyk7XG5cdFx0dGhpcy5vcGVudmlkdVNlcnZpY2UuZGlzY29ubmVjdCgpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHN1YnNjcmliZVRvVG9nZ2xpbmdNZW51KCkge1xuXHRcdHRoaXMuc2lkZU1lbnUub3BlbmVkQ2hhbmdlLnN1YnNjcmliZSgoKSA9PiB7XG5cdFx0XHR0aGlzLnN0b3BVcGRhdGVMYXlvdXRJbnRlcnZhbCgpO1xuXHRcdFx0dGhpcy5sYXlvdXRTZXJ2aWNlLnVwZGF0ZSgpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zaWRlTWVudS5vcGVuZWRTdGFydC5zdWJzY3JpYmUoKCkgPT4ge1xuXHRcdFx0dGhpcy5zdGFydFVwZGF0ZUxheW91dEludGVydmFsKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNpZGVNZW51LmNsb3NlZFN0YXJ0LnN1YnNjcmliZSgoKSA9PiB7XG5cdFx0XHR0aGlzLnN0YXJ0VXBkYXRlTGF5b3V0SW50ZXJ2YWwoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMubWVudVN1YnNjcmlwdGlvbiA9IHRoaXMucGFuZWxTZXJ2aWNlLnBhbmVsT3BlbmVkT2JzLnBpcGUoc2tpcCgxKSkuc3Vic2NyaWJlKChldjogUGFuZWxFdmVudCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuc2lkZU1lbnUpIHtcblx0XHRcdFx0dGhpcy5zZXR0aW5nc1BhbmVsT3BlbmVkID0gZXYub3BlbmVkICYmIGV2LnR5cGUgPT09IFBhbmVsVHlwZS5TRVRUSU5HUztcblxuXHRcdFx0XHRpZiAodGhpcy5zaWRlTWVudS5vcGVuZWQgJiYgZXYub3BlbmVkKSB7XG5cdFx0XHRcdFx0aWYgKGV2LnR5cGUgPT09IFBhbmVsVHlwZS5TRVRUSU5HUyB8fCBldi5vbGRUeXBlID09PSBQYW5lbFR5cGUuU0VUVElOR1MpIHtcblx0XHRcdFx0XHRcdC8vIFN3aXRjaCBmcm9tIFNFVFRJTkdTIHRvIGFub3RoZXIgcGFuZWwgYW5kIHZpY2UgdmVyc2EuXG5cdFx0XHRcdFx0XHQvLyBBcyB0aGUgU0VUVElOR1MgcGFuZWwgd2lsbCBiZSBiaWdnZXIgdGhhbiBvdGhlcnMsIHRoZSBzaWRlbmF2IGNvbnRhaW5lciBtdXN0IGJlIHVwZGF0ZWQuXG5cdFx0XHRcdFx0XHQvLyBTZXR0aW5nIGF1dG9zaXplIHRvICd0cnVlJyBhbGxvd3MgdXBkYXRlIGl0LlxuXHRcdFx0XHRcdFx0dGhpcy5kcmF3ZXIuYXV0b3NpemUgPSB0cnVlO1xuXHRcdFx0XHRcdFx0dGhpcy5zdGFydFVwZGF0ZUxheW91dEludGVydmFsKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGV2Lm9wZW5lZCA/IHRoaXMuc2lkZU1lbnUub3BlbigpIDogdGhpcy5zaWRlTWVudS5jbG9zZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJvdGVjdGVkIHN1YnNjcmliZVRvTGF5b3V0V2lkdGgoKSB7XG5cdFx0dGhpcy5sYXlvdXRXaWR0aFN1YnNjcmlwdGlvbiA9IHRoaXMubGF5b3V0U2VydmljZS5sYXlvdXRXaWR0aE9icy5zdWJzY3JpYmUoKHdpZHRoKSA9PiB7XG5cdFx0XHR0aGlzLnNpZGVuYXZNb2RlID0gd2lkdGggPD0gdGhpcy5TSURFTkFWX1dJRFRIX0xJTUlUX01PREUgPyBTaWRlbmF2TW9kZS5PVkVSIDogU2lkZW5hdk1vZGUuU0lERTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY29ubmVjdFRvU2Vzc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgd2ViY2FtVG9rZW4gPSB0aGlzLm9wZW52aWR1U2VydmljZS5nZXRXZWJjYW1Ub2tlbigpO1xuXHRcdFx0Y29uc3Qgc2NyZWVuVG9rZW4gPSB0aGlzLm9wZW52aWR1U2VydmljZS5nZXRTY3JlZW5Ub2tlbigpO1xuXG5cdFx0XHRpZiAodGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UuaGF2ZUlDYW1lcmFBbmRTY3JlZW5BY3RpdmUoKSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLm9wZW52aWR1U2VydmljZS5jb25uZWN0U2Vzc2lvbih0aGlzLm9wZW52aWR1U2VydmljZS5nZXRXZWJjYW1TZXNzaW9uKCksIHdlYmNhbVRva2VuKTtcblx0XHRcdFx0YXdhaXQgdGhpcy5vcGVudmlkdVNlcnZpY2UuY29ubmVjdFNlc3Npb24odGhpcy5vcGVudmlkdVNlcnZpY2UuZ2V0U2NyZWVuU2Vzc2lvbigpLCBzY3JlZW5Ub2tlbik7XG5cdFx0XHRcdGF3YWl0IHRoaXMub3BlbnZpZHVTZXJ2aWNlLnB1Ymxpc2godGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UuZ2V0TXlDYW1lcmFQdWJsaXNoZXIoKSk7XG5cdFx0XHRcdGF3YWl0IHRoaXMub3BlbnZpZHVTZXJ2aWNlLnB1Ymxpc2godGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UuZ2V0TXlTY3JlZW5QdWJsaXNoZXIoKSk7XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmlzT25seU15U2NyZWVuQWN0aXZlKCkpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5vcGVudmlkdVNlcnZpY2UuY29ubmVjdFNlc3Npb24odGhpcy5vcGVudmlkdVNlcnZpY2UuZ2V0U2NyZWVuU2Vzc2lvbigpLCBzY3JlZW5Ub2tlbik7XG5cdFx0XHRcdGF3YWl0IHRoaXMub3BlbnZpZHVTZXJ2aWNlLnB1Ymxpc2godGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UuZ2V0TXlTY3JlZW5QdWJsaXNoZXIoKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhd2FpdCB0aGlzLm9wZW52aWR1U2VydmljZS5jb25uZWN0U2Vzc2lvbih0aGlzLm9wZW52aWR1U2VydmljZS5nZXRXZWJjYW1TZXNzaW9uKCksIHdlYmNhbVRva2VuKTtcblx0XHRcdFx0YXdhaXQgdGhpcy5vcGVudmlkdVNlcnZpY2UucHVibGlzaCh0aGlzLnBhcnRpY2lwYW50U2VydmljZS5nZXRNeUNhbWVyYVB1Ymxpc2hlcigpKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gdGhpcy5fZXJyb3IuZW1pdCh7IGVycm9yOiBlcnJvci5lcnJvciwgbWVzc2dhZTogZXJyb3IubWVzc2FnZSwgY29kZTogZXJyb3IuY29kZSwgc3RhdHVzOiBlcnJvci5zdGF0dXMgfSk7XG5cdFx0XHR0aGlzLmxvZy5lKCdUaGVyZSB3YXMgYW4gZXJyb3IgY29ubmVjdGluZyB0byB0aGUgc2Vzc2lvbjonLCBlcnJvci5jb2RlLCBlcnJvci5tZXNzYWdlKTtcblx0XHRcdHRoaXMuYWN0aW9uU2VydmljZS5vcGVuRGlhbG9nKHRoaXMudHJhbnNsYXRlU2VydmljZS50cmFuc2xhdGUoJ0VSUk9SUy5TRVNTSU9OJyksIGVycm9yPy5lcnJvciB8fCBlcnJvcj8ubWVzc2FnZSB8fCBlcnJvcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzdWJzY3JpYmVUb09wZW5WaWR1RXhjZXB0aW9uKCkge1xuXHRcdHRoaXMuc2Vzc2lvbi5vbignZXhjZXB0aW9uJywgKGV2ZW50OiBFeGNlcHRpb25FdmVudCkgPT4ge1xuXHRcdFx0dGhpcy5sb2cuZShldmVudC5uYW1lLCBldmVudC5tZXNzYWdlKTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc3Vic2NyaWJlVG9Db25uZWN0aW9uQ3JlYXRlZEFuZERlc3Ryb3llZCgpIHtcblx0XHR0aGlzLnNlc3Npb24ub24oJ2Nvbm5lY3Rpb25DcmVhdGVkJywgKGV2ZW50OiBDb25uZWN0aW9uRXZlbnQpID0+IHtcblx0XHRcdGNvbnN0IGNvbm5lY3Rpb25JZCA9IGV2ZW50LmNvbm5lY3Rpb24/LmNvbm5lY3Rpb25JZDtcblx0XHRcdGNvbnN0IG5pY2tuYW1lOiBzdHJpbmcgPSB0aGlzLnBhcnRpY2lwYW50U2VydmljZS5nZXROaWNrbmFtZUZyb21Db25uZWN0aW9uRGF0YShldmVudC5jb25uZWN0aW9uLmRhdGEpO1xuXHRcdFx0Y29uc3QgaXNSZW1vdGVDb25uZWN0aW9uOiBib29sZWFuID0gIXRoaXMub3BlbnZpZHVTZXJ2aWNlLmlzTXlPd25Db25uZWN0aW9uKGNvbm5lY3Rpb25JZCk7XG5cdFx0XHRjb25zdCBpc0NhbWVyYUNvbm5lY3Rpb246IGJvb2xlYW4gPSAhbmlja25hbWU/LmluY2x1ZGVzKGBfJHtWaWRlb1R5cGUuU0NSRUVOfWApO1xuXHRcdFx0Y29uc3QgZGF0YSA9IGV2ZW50LmNvbm5lY3Rpb24/LmRhdGE7XG5cblx0XHRcdGlmIChpc1JlbW90ZUNvbm5lY3Rpb24gJiYgaXNDYW1lcmFDb25uZWN0aW9uKSB7XG5cdFx0XHRcdC8vIEFkZGluZyBwYXJ0aWNpcGFudCB3aGVuIGNvbm5lY3Rpb24gaXMgY3JlYXRlZCBhbmQgaXQncyBub3Qgc2NyZWVuXG5cdFx0XHRcdHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmFkZFJlbW90ZUNvbm5lY3Rpb24oY29ubmVjdGlvbklkLCBkYXRhLCBudWxsKTtcblxuXHRcdFx0XHQvL1NlbmRpbmcgbmljbmthbm1lIHNpZ25hbCB0byBuZXcgcGFydGljaXBhbnRzXG5cdFx0XHRcdGlmICh0aGlzLm9wZW52aWR1U2VydmljZS5uZWVkU2VuZE5pY2tuYW1lU2lnbmFsKCkpIHtcblx0XHRcdFx0XHRjb25zdCBkYXRhID0geyBjbGllbnREYXRhOiB0aGlzLnBhcnRpY2lwYW50U2VydmljZS5nZXRNeU5pY2tuYW1lKCkgfTtcblx0XHRcdFx0XHR0aGlzLm9wZW52aWR1U2VydmljZS5zZW5kU2lnbmFsKFNpZ25hbC5OSUNLTkFNRV9DSEFOR0VELCBbZXZlbnQuY29ubmVjdGlvbl0sIGRhdGEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNlc3Npb24ub24oJ2Nvbm5lY3Rpb25EZXN0cm95ZWQnLCAoZXZlbnQ6IENvbm5lY3Rpb25FdmVudCkgPT4ge1xuXHRcdFx0Y29uc3Qgbmlja25hbWU6IHN0cmluZyA9IHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmdldE5pY2tuYW1lRnJvbUNvbm5lY3Rpb25EYXRhKGV2ZW50LmNvbm5lY3Rpb24uZGF0YSk7XG5cdFx0XHRjb25zdCBpc1JlbW90ZUNvbm5lY3Rpb246IGJvb2xlYW4gPSAhdGhpcy5vcGVudmlkdVNlcnZpY2UuaXNNeU93bkNvbm5lY3Rpb24oZXZlbnQuY29ubmVjdGlvbi5jb25uZWN0aW9uSWQpO1xuXHRcdFx0Y29uc3QgaXNDYW1lcmFDb25uZWN0aW9uOiBib29sZWFuID0gIW5pY2tuYW1lPy5pbmNsdWRlcyhgXyR7VmlkZW9UeXBlLlNDUkVFTn1gKTtcblx0XHRcdC8vIERlbGV0aW5nIHBhcnRpY2lwYW50IHdoZW4gY29ubmVjdGlvbiBpcyBkZXN0cm95ZWRcblx0XHRcdGlmIChpc1JlbW90ZUNvbm5lY3Rpb24gJiYgaXNDYW1lcmFDb25uZWN0aW9uKSB7XG5cdFx0XHRcdHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLnJlbW92ZUNvbm5lY3Rpb25CeUNvbm5lY3Rpb25JZChldmVudC5jb25uZWN0aW9uLmNvbm5lY3Rpb25JZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHN1YnNjcmliZVRvU3RyZWFtQ3JlYXRlZCgpIHtcblx0XHR0aGlzLnNlc3Npb24ub24oJ3N0cmVhbUNyZWF0ZWQnLCBhc3luYyAoZXZlbnQ6IFN0cmVhbUV2ZW50KSA9PiB7XG5cdFx0XHRjb25zdCBjb25uZWN0aW9uSWQgPSBldmVudC5zdHJlYW0/LmNvbm5lY3Rpb24/LmNvbm5lY3Rpb25JZDtcblx0XHRcdGNvbnN0IGRhdGEgPSBldmVudC5zdHJlYW0/LmNvbm5lY3Rpb24/LmRhdGE7XG5cdFx0XHRjb25zdCBpc0NhbWVyYVR5cGU6IGJvb2xlYW4gPSB0aGlzLnBhcnRpY2lwYW50U2VydmljZS5nZXRUeXBlQ29ubmVjdGlvbkRhdGEoZGF0YSkgPT09IFZpZGVvVHlwZS5DQU1FUkE7XG5cdFx0XHRjb25zdCBpc1JlbW90ZUNvbm5lY3Rpb246IGJvb2xlYW4gPSAhdGhpcy5vcGVudmlkdVNlcnZpY2UuaXNNeU93bkNvbm5lY3Rpb24oY29ubmVjdGlvbklkKTtcblxuXHRcdFx0aWYgKGlzUmVtb3RlQ29ubmVjdGlvbikge1xuXHRcdFx0XHRjb25zdCBzdWJzY3JpYmVyOiBTdWJzY3JpYmVyID0gdGhpcy5zZXNzaW9uLnN1YnNjcmliZShldmVudC5zdHJlYW0sIHVuZGVmaW5lZCk7XG5cdFx0XHRcdHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmFkZFJlbW90ZUNvbm5lY3Rpb24oY29ubmVjdGlvbklkLCBkYXRhLCBzdWJzY3JpYmVyKTtcblx0XHRcdFx0Ly8gdGhpcy5vVlNlc3Npb25TZXJ2aWNlLnNlbmROaWNrbmFtZVNpZ25hbChldmVudC5zdHJlYW0uY29ubmVjdGlvbik7XG5cblx0XHRcdFx0aWYgKHRoaXMuY2FwdGlvblNlcnZpY2UuYXJlQ2FwdGlvbnNFbmFibGVkKCkgJiYgaXNDYW1lcmFUeXBlKSB7XG5cdFx0XHRcdFx0Ly8gT25seSBzdWJzY3JpYmUgdG8gU1RUIHdoZW4gc3RyZWFtIGlzIENBTUVSQSB0eXBlIGFuZCBpdCBpcyBhIHJlbW90ZSBzdHJlYW1cblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5zZXNzaW9uLnN1YnNjcmliZVRvU3BlZWNoVG9UZXh0KGV2ZW50LnN0cmVhbSwgdGhpcy5jYXB0aW9uU2VydmljZS5nZXRMYW5nU2VsZWN0ZWQoKS5JU08pO1xuXHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmxvZy5lKCdFcnJvciBzdWJzY3JpYmluZyBmcm9tIFNUVDogJywgZXJyb3IpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdWJzY3JpYmVUb1N0cmVhbURlc3Ryb3llZCgpIHtcblx0XHR0aGlzLnNlc3Npb24ub24oJ3N0cmVhbURlc3Ryb3llZCcsIGFzeW5jIChldmVudDogU3RyZWFtRXZlbnQpID0+IHtcblx0XHRcdGNvbnN0IGNvbm5lY3Rpb25JZCA9IGV2ZW50LnN0cmVhbS5jb25uZWN0aW9uLmNvbm5lY3Rpb25JZDtcblx0XHRcdGNvbnN0IGRhdGEgPSBldmVudC5zdHJlYW0/LmNvbm5lY3Rpb24/LmRhdGE7XG5cdFx0XHRjb25zdCBpc1JlbW90ZUNvbm5lY3Rpb246IGJvb2xlYW4gPSAhdGhpcy5vcGVudmlkdVNlcnZpY2UuaXNNeU93bkNvbm5lY3Rpb24oY29ubmVjdGlvbklkKTtcblx0XHRcdGNvbnN0IGlzQ2FtZXJhVHlwZTogYm9vbGVhbiA9IHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmdldFR5cGVDb25uZWN0aW9uRGF0YShkYXRhKSA9PT0gVmlkZW9UeXBlLkNBTUVSQTtcblxuXHRcdFx0dGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UucmVtb3ZlQ29ubmVjdGlvbkJ5Q29ubmVjdGlvbklkKGNvbm5lY3Rpb25JZCk7XG5cdFx0XHRpZiAoaXNSZW1vdGVDb25uZWN0aW9uKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNhcHRpb25TZXJ2aWNlLmFyZUNhcHRpb25zRW5hYmxlZCgpICYmIGlzQ2FtZXJhVHlwZSkge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnNlc3Npb24udW5zdWJzY3JpYmVGcm9tU3BlZWNoVG9UZXh0KGV2ZW50LnN0cmVhbSk7XG5cdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdHRoaXMubG9nLmUoJ0Vycm9yIHVuc3Vic2NyaWJpbmcgZnJvbSBTVFQ6ICcsIGVycm9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc3Vic2NyaWJlVG9DYXB0aW9uTGFuZ3VhZ2UoKSB7XG5cdFx0dGhpcy5jYXB0aW9uTGFuZ3VhZ2VTdWJzY3JpcHRpb24gPSB0aGlzLmNhcHRpb25TZXJ2aWNlLmNhcHRpb25MYW5nT2JzLnN1YnNjcmliZShhc3luYyAobGFuZykgPT4ge1xuXHRcdFx0aWYgKHRoaXMuY2FwdGlvblNlcnZpY2UuYXJlQ2FwdGlvbnNFbmFibGVkKCkpIHtcblx0XHRcdFx0Ly8gVW5zdWJzY3JpYmUgYWxsIHN0cmVhbXMgZnJvbSBzcGVlY2ggdG8gdGV4dCBhbmQgcmUtc3Vic2NyaWJlIHdpdGggbmV3IGxhbmd1YWdlXG5cdFx0XHRcdHRoaXMubG9nLmQoJ1JlLXN1YnNjcmliZSBmcm9tIFNUVCBiZWNhdXNlIG9mIGxhbmd1YWdlIGNoYW5nZWQgdG8gJywgbGFuZy5JU08pO1xuXHRcdFx0XHRmb3IgKGNvbnN0IHBhcnRpY2lwYW50IG9mIHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLmdldFJlbW90ZVBhcnRpY2lwYW50cygpKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc3RyZWFtTWFuYWdlciA9IHBhcnRpY2lwYW50LmdldENhbWVyYUNvbm5lY3Rpb24oKT8uc3RyZWFtTWFuYWdlcjtcblx0XHRcdFx0XHRpZiAoISFzdHJlYW1NYW5hZ2VyPy5zdHJlYW0pIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMuc2Vzc2lvbi51bnN1YnNjcmliZUZyb21TcGVlY2hUb1RleHQoc3RyZWFtTWFuYWdlci5zdHJlYW0pO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnNlc3Npb24uc3Vic2NyaWJlVG9TcGVlY2hUb1RleHQoc3RyZWFtTWFuYWdlci5zdHJlYW0sIGxhbmcuSVNPKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMubG9nLmUoJ0Vycm9yIHJlLXN1YnNjcmliaW5nIHRvIFNUVDogJywgZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdWJzY3JpYmVUb1N0cmVhbVByb3BlcnR5Q2hhbmdlKCkge1xuXHRcdHRoaXMuc2Vzc2lvbi5vbignc3RyZWFtUHJvcGVydHlDaGFuZ2VkJywgKGV2ZW50OiBTdHJlYW1Qcm9wZXJ0eUNoYW5nZWRFdmVudCkgPT4ge1xuXHRcdFx0Y29uc3QgY29ubmVjdGlvbklkID0gZXZlbnQuc3RyZWFtLmNvbm5lY3Rpb24uY29ubmVjdGlvbklkO1xuXHRcdFx0Y29uc3QgaXNSZW1vdGVDb25uZWN0aW9uOiBib29sZWFuID0gIXRoaXMub3BlbnZpZHVTZXJ2aWNlLmlzTXlPd25Db25uZWN0aW9uKGNvbm5lY3Rpb25JZCk7XG5cdFx0XHRpZiAoaXNSZW1vdGVDb25uZWN0aW9uKSB7XG5cdFx0XHRcdHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLnVwZGF0ZVJlbW90ZVBhcnRpY2lwYW50cygpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdWJzY3JpYmVUb05pY2tuYW1lQ2hhbmdlZCgpIHtcblx0XHR0aGlzLnNlc3Npb24ub24oYHNpZ25hbDoke1NpZ25hbC5OSUNLTkFNRV9DSEFOR0VEfWAsIChldmVudDogYW55KSA9PiB7XG5cdFx0XHRjb25zdCBjb25uZWN0aW9uSWQgPSBldmVudC5mcm9tLmNvbm5lY3Rpb25JZDtcblx0XHRcdGNvbnN0IGlzUmVtb3RlQ29ubmVjdGlvbjogYm9vbGVhbiA9ICF0aGlzLm9wZW52aWR1U2VydmljZS5pc015T3duQ29ubmVjdGlvbihjb25uZWN0aW9uSWQpO1xuXG5cdFx0XHRpZiAoaXNSZW1vdGVDb25uZWN0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IG5pY2tuYW1lID0gdGhpcy5wYXJ0aWNpcGFudFNlcnZpY2UuZ2V0Tmlja25hbWVGcm9tQ29ubmVjdGlvbkRhdGEoZXZlbnQuZGF0YSk7XG5cdFx0XHRcdHRoaXMucGFydGljaXBhbnRTZXJ2aWNlLnNldFJlbW90ZU5pY2tuYW1lKGNvbm5lY3Rpb25JZCwgbmlja25hbWUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdWJzY3JpYmVUb1JlY29ubmVjdGlvbigpIHtcblx0XHR0aGlzLnNlc3Npb24ub24oJ3JlY29ubmVjdGluZycsICgpID0+IHtcblx0XHRcdHRoaXMubG9nLncoJ0Nvbm5lY3Rpb24gbG9zdDogUmVjb25uZWN0aW5nJyk7XG5cdFx0XHR0aGlzLmFjdGlvblNlcnZpY2Uub3BlbkRpYWxvZyhcblx0XHRcdFx0dGhpcy50cmFuc2xhdGVTZXJ2aWNlLnRyYW5zbGF0ZSgnRVJST1JTLkNPTk5FQ1RJT04nKSxcblx0XHRcdFx0dGhpcy50cmFuc2xhdGVTZXJ2aWNlLnRyYW5zbGF0ZSgnRVJST1JTLlJFQ09OTkVDVCcpLFxuXHRcdFx0XHRmYWxzZVxuXHRcdFx0KTtcblx0XHR9KTtcblx0XHR0aGlzLnNlc3Npb24ub24oJ3JlY29ubmVjdGVkJywgKCkgPT4ge1xuXHRcdFx0dGhpcy5sb2cudygnQ29ubmVjdGlvbiBsb3N0OiBSZWNvbm5lY3RlZCcpO1xuXHRcdFx0dGhpcy5hY3Rpb25TZXJ2aWNlLmNsb3NlRGlhbG9nKCk7XG5cdFx0fSk7XG5cdFx0dGhpcy5zZXNzaW9uLm9uKCdzZXNzaW9uRGlzY29ubmVjdGVkJywgKGV2ZW50OiBTZXNzaW9uRGlzY29ubmVjdGVkRXZlbnQpID0+IHtcblx0XHRcdGlmIChldmVudC5yZWFzb24gPT09ICdub2RlQ3Jhc2hlZCcpIHtcblx0XHRcdFx0dGhpcy5hY3Rpb25TZXJ2aWNlLm9wZW5EaWFsb2coXG5cdFx0XHRcdFx0dGhpcy50cmFuc2xhdGVTZXJ2aWNlLnRyYW5zbGF0ZSgnRVJST1JTLkNPTk5FQ1RJT04nKSxcblx0XHRcdFx0XHR0aGlzLnRyYW5zbGF0ZVNlcnZpY2UudHJhbnNsYXRlKCdFUlJPUlMuUkVDT05ORUNUJyksXG5cdFx0XHRcdFx0ZmFsc2Vcblx0XHRcdFx0KTtcblx0XHRcdFx0dGhpcy5vbk5vZGVDcmFzaGVkLmVtaXQoKTtcblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQucmVhc29uID09PSAnbmV0d29ya0Rpc2Nvbm5lY3QnKSB7XG5cdFx0XHRcdHRoaXMuYWN0aW9uU2VydmljZS5jbG9zZURpYWxvZygpO1xuXHRcdFx0XHR0aGlzLmxlYXZlU2Vzc2lvbigpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdWJzY3JpYmVUb1JlY29yZGluZ0V2ZW50cygpIHtcblx0XHR0aGlzLnNlc3Npb24ub24oJ3JlY29yZGluZ1N0YXJ0ZWQnLCAoZXZlbnQ6IFJlY29yZGluZ0V2ZW50KSA9PiB7XG5cdFx0XHR0aGlzLnJlY29yZGluZ1NlcnZpY2Uuc3RhcnRSZWNvcmRpbmcoZXZlbnQpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZXNzaW9uLm9uKCdyZWNvcmRpbmdTdG9wcGVkJywgKGV2ZW50OiBSZWNvcmRpbmdFdmVudCkgPT4ge1xuXHRcdFx0dGhpcy5yZWNvcmRpbmdTZXJ2aWNlLnN0b3BSZWNvcmRpbmcoZXZlbnQpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGFydFVwZGF0ZUxheW91dEludGVydmFsKCkge1xuXHRcdHRoaXMudXBkYXRlTGF5b3V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG5cdFx0XHR0aGlzLmxheW91dFNlcnZpY2UudXBkYXRlKCk7XG5cdFx0fSwgNTApO1xuXHR9XG5cblx0cHJpdmF0ZSBzdG9wVXBkYXRlTGF5b3V0SW50ZXJ2YWwoKSB7XG5cdFx0aWYgKHRoaXMudXBkYXRlTGF5b3V0SW50ZXJ2YWwpIHtcblx0XHRcdGNsZWFySW50ZXJ2YWwodGhpcy51cGRhdGVMYXlvdXRJbnRlcnZhbCk7XG5cdFx0fVxuXHR9XG59XG4iLCI8ZGl2IGlkPVwic2Vzc2lvbi1jb250YWluZXJcIiAqbmdJZj1cIiFwcmVwYXJpbmdcIiBAc2Vzc2lvbkFuaW1hdGlvbj5cblx0PG1hdC1zaWRlbmF2LWNvbnRhaW5lciAjY29udGFpbmVyICN2aWRlb0NvbnRhaW5lciBjbGFzcz1cInNpZGVuYXYtY29udGFpbmVyXCI+XG5cdFx0PG1hdC1zaWRlbmF2XG5cdFx0XHQjc2lkZW5hdlxuXHRcdFx0bW9kZT1cInt7IHNpZGVuYXZNb2RlIH19XCJcblx0XHRcdHBvc2l0aW9uPVwiZW5kXCJcblx0XHRcdGNsYXNzPVwic2lkZW5hdi1tZW51XCJcblx0XHRcdFtuZ0NsYXNzXT1cIntiaWc6IHNldHRpbmdzUGFuZWxPcGVuZWR9XCJcblx0XHRcdGZpeGVkSW5WaWV3cG9ydD1cInRydWVcIlxuXHRcdFx0Zml4ZWRUb3BHYXA9XCIwXCJcblx0XHRcdGZpeGVkQm90dG9tR2FwPVwiMFwiXG5cdFx0PlxuXHRcdFx0PG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInBhbmVsVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cblx0XHQ8L21hdC1zaWRlbmF2PlxuXG5cdFx0PG1hdC1zaWRlbmF2LWNvbnRlbnQgY2xhc3M9XCJzaWRlbmF2LW1haW5cIj5cblx0XHRcdDxkaXYgaWQ9XCJsYXlvdXQtY29udGFpbmVyXCIgICNsYXlvdXRDb250YWluZXI+XG5cdFx0XHRcdDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJsYXlvdXRUZW1wbGF0ZVwiPjwvbmctY29udGFpbmVyPlxuXHRcdFx0PC9kaXY+XG5cdFx0PC9tYXQtc2lkZW5hdi1jb250ZW50PlxuXHQ8L21hdC1zaWRlbmF2LWNvbnRhaW5lcj5cblxuXHQ8ZGl2IGlkPVwiZm9vdGVyLWNvbnRhaW5lclwiICpuZ0lmPVwidG9vbGJhclRlbXBsYXRlXCI+XG5cdFx0PG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInRvb2xiYXJUZW1wbGF0ZVwiPjwvbmctY29udGFpbmVyPlxuXHQ8L2Rpdj5cbjwvZGl2PlxuIl19