import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { LayoutAlignment, LayoutClass, OpenViduLayout } from '../../models/layout.model';
import * as i0 from "@angular/core";
/**
 * @internal
 */
export class LayoutService {
    constructor() {
        this.layoutContainer = null;
        this.layoutWidth = new BehaviorSubject(0);
        this.captionsToggling = new BehaviorSubject(false);
        this.layoutWidthObs = this.layoutWidth.asObservable();
        this.captionsTogglingObs = this.captionsToggling.asObservable();
    }
    initialize(container) {
        this.layoutContainer = container;
        this.openviduLayout = new OpenViduLayout();
        this.openviduLayoutOptions = this.getOptions();
        if (this.layoutContainer) {
            this.openviduLayout.initLayoutContainer(this.layoutContainer, this.openviduLayoutOptions);
        }
        this.sendLayoutWidthEvent();
    }
    getOptions() {
        const options = {
            maxRatio: 3 / 2,
            minRatio: 9 / 16,
            fixedRatio: false /* If this is true then the aspect ratio of the video is maintained
      and minRatio and maxRatio are ignored (default false) */,
            bigClass: LayoutClass.BIG_ELEMENT,
            smallClass: LayoutClass.SMALL_ELEMENT,
            ignoredClass: LayoutClass.IGNORED_ELEMENT,
            bigPercentage: 0.8,
            minBigPercentage: 0,
            bigFixedRatio: false,
            bigMaxRatio: 9 / 16,
            bigMinRatio: 9 / 16,
            bigFirst: true,
            animate: true,
            alignItems: LayoutAlignment.CENTER,
            bigAlignItems: LayoutAlignment.CENTER,
            smallAlignItems: LayoutAlignment.CENTER,
            maxWidth: Infinity,
            maxHeight: Infinity,
            smallMaxWidth: Infinity,
            smallMaxHeight: Infinity,
            bigMaxWidth: Infinity,
            bigMaxHeight: Infinity,
            scaleLastRow: true,
            bigScaleLastRow: true
        };
        return options;
    }
    toggleCaptions() {
        this.captionsToggling.next(!this.captionsToggling.getValue());
    }
    update(timeout = null) {
        const updateAux = () => {
            if (!!this.openviduLayout) {
                this.openviduLayout.updateLayout(this.layoutContainer, this.openviduLayoutOptions);
                this.sendLayoutWidthEvent();
            }
        };
        if (typeof timeout === 'number' && timeout >= 0) {
            setTimeout(() => updateAux(), timeout);
        }
        else {
            updateAux();
        }
    }
    getLayout() {
        return this.openviduLayout;
    }
    clear() {
        this.openviduLayout = null;
    }
    sendLayoutWidthEvent() {
        const sidenavLayoutElement = this.getHTMLElementByClassName(this.openviduLayout?.getLayoutContainer(), LayoutClass.SIDENAV_CONTAINER);
        if (sidenavLayoutElement && sidenavLayoutElement.clientWidth) {
            this.layoutWidth.next(sidenavLayoutElement.clientWidth);
        }
    }
    getHTMLElementByClassName(element, className) {
        while (!!element && element !== document.body) {
            if (element.className.includes(className)) {
                return element;
            }
            element = element.parentElement;
        }
        return null;
    }
}
LayoutService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: LayoutService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });
LayoutService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: LayoutService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: LayoutService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return []; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5b3V0LnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9vcGVudmlkdS1hbmd1bGFyL3NyYy9saWIvc2VydmljZXMvbGF5b3V0L2xheW91dC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLGVBQWUsRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUNuRCxPQUFPLEVBQUUsZUFBZSxFQUFFLFdBQVcsRUFBRSxjQUFjLEVBQXlCLE1BQU0sMkJBQTJCLENBQUM7O0FBRWhIOztHQUVHO0FBSUgsTUFBTSxPQUFPLGFBQWE7SUFTekI7UUFSQSxvQkFBZSxHQUF1QixJQUFJLENBQUM7UUFHbkMsZ0JBQVcsR0FBNEIsSUFBSSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFHOUQscUJBQWdCLEdBQTZCLElBQUksZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRy9FLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUN0RCxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ2pFLENBQUM7SUFFRCxVQUFVLENBQUMsU0FBc0I7UUFDaEMsSUFBSSxDQUFDLGVBQWUsR0FBRyxTQUFTLENBQUM7UUFDakMsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLGNBQWMsRUFBRSxDQUFDO1FBQzNDLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDL0MsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3pCLElBQUksQ0FBQyxjQUFjLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztTQUMx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QUM7U0FDaEM7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNiLENBQUM7OzBHQW5HVyxhQUFhOzhHQUFiLGFBQWEsY0FGYixNQUFNOzJGQUVOLGFBQWE7a0JBSHpCLFVBQVU7bUJBQUM7b0JBQ1gsVUFBVSxFQUFFLE1BQU07aUJBQ2xCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBMYXlvdXRBbGlnbm1lbnQsIExheW91dENsYXNzLCBPcGVuVmlkdUxheW91dCwgT3BlblZpZHVMYXlvdXRPcHRpb25zIH0gZnJvbSAnLi4vLi4vbW9kZWxzL2xheW91dC5tb2RlbCc7XG5cbi8qKlxuICogQGludGVybmFsXG4gKi9cbkBJbmplY3RhYmxlKHtcblx0cHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIExheW91dFNlcnZpY2Uge1xuXHRsYXlvdXRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdGxheW91dFdpZHRoT2JzOiBPYnNlcnZhYmxlPG51bWJlcj47XG5cdGNhcHRpb25zVG9nZ2xpbmdPYnM6IE9ic2VydmFibGU8Ym9vbGVhbj47XG5cdHByaXZhdGUgbGF5b3V0V2lkdGg6IEJlaGF2aW9yU3ViamVjdDxudW1iZXI+ID0gbmV3IEJlaGF2aW9yU3ViamVjdCgwKTtcblx0cHJpdmF0ZSBvcGVudmlkdUxheW91dDogT3BlblZpZHVMYXlvdXQ7XG5cdHByaXZhdGUgb3BlbnZpZHVMYXlvdXRPcHRpb25zOiBPcGVuVmlkdUxheW91dE9wdGlvbnM7XG5cdHByaXZhdGUgY2FwdGlvbnNUb2dnbGluZzogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSk7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0dGhpcy5sYXlvdXRXaWR0aE9icyA9IHRoaXMubGF5b3V0V2lkdGguYXNPYnNlcnZhYmxlKCk7XG5cdFx0dGhpcy5jYXB0aW9uc1RvZ2dsaW5nT2JzID0gdGhpcy5jYXB0aW9uc1RvZ2dsaW5nLmFzT2JzZXJ2YWJsZSgpO1xuXHR9XG5cblx0aW5pdGlhbGl6ZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5sYXlvdXRDb250YWluZXIgPSBjb250YWluZXI7XG5cdFx0dGhpcy5vcGVudmlkdUxheW91dCA9IG5ldyBPcGVuVmlkdUxheW91dCgpO1xuXHRcdHRoaXMub3BlbnZpZHVMYXlvdXRPcHRpb25zID0gdGhpcy5nZXRPcHRpb25zKCk7XG5cdFx0aWYgKHRoaXMubGF5b3V0Q29udGFpbmVyKSB7XG5cdFx0XHR0aGlzLm9wZW52aWR1TGF5b3V0LmluaXRMYXlvdXRDb250YWluZXIodGhpcy5sYXlvdXRDb250YWluZXIsIHRoaXMub3BlbnZpZHVMYXlvdXRPcHRpb25zKTtcblx0XHR9XG5cdFx0dGhpcy5zZW5kTGF5b3V0V2lkdGhFdmVudCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRPcHRpb25zKCk6IE9wZW5WaWR1TGF5b3V0T3B0aW9ucyB7XG5cdFx0Y29uc3Qgb3B0aW9ucyA9IHtcblx0XHRcdG1heFJhdGlvOiAzIC8gMiwgLy8gVGhlIG5hcnJvd2VzdCByYXRpbyB0aGF0IHdpbGwgYmUgdXNlZCAoZGVmYXVsdCAyeDMpXG5cdFx0XHRtaW5SYXRpbzogOSAvIDE2LCAvLyBUaGUgd2lkZXN0IHJhdGlvIHRoYXQgd2lsbCBiZSB1c2VkIChkZWZhdWx0IDE2eDkpXG5cdFx0XHRmaXhlZFJhdGlvOiBmYWxzZSAvKiBJZiB0aGlzIGlzIHRydWUgdGhlbiB0aGUgYXNwZWN0IHJhdGlvIG9mIHRoZSB2aWRlbyBpcyBtYWludGFpbmVkXG4gICAgICBhbmQgbWluUmF0aW8gYW5kIG1heFJhdGlvIGFyZSBpZ25vcmVkIChkZWZhdWx0IGZhbHNlKSAqLyxcblx0XHRcdGJpZ0NsYXNzOiBMYXlvdXRDbGFzcy5CSUdfRUxFTUVOVCwgLy8gVGhlIGNsYXNzIHRvIGFkZCB0byBlbGVtZW50cyB0aGF0IHNob3VsZCBiZSBzaXplZCBiaWdnZXJcblx0XHRcdHNtYWxsQ2xhc3M6IExheW91dENsYXNzLlNNQUxMX0VMRU1FTlQsXG5cdFx0XHRpZ25vcmVkQ2xhc3M6IExheW91dENsYXNzLklHTk9SRURfRUxFTUVOVCxcblx0XHRcdGJpZ1BlcmNlbnRhZ2U6IDAuOCwgLy8gVGhlIG1heGltdW0gcGVyY2VudGFnZSBvZiBzcGFjZSB0aGUgYmlnIG9uZXMgc2hvdWxkIHRha2UgdXBcblx0XHRcdG1pbkJpZ1BlcmNlbnRhZ2U6IDAsIC8vIElmIHRoaXMgaXMgc2V0IHRoZW4gaXQgd2lsbCBzY2FsZSBkb3duIHRoZSBiaWcgc3BhY2UgaWYgdGhlcmUgaXMgbGVmdCBvdmVyIHdoaXRlc3BhY2UgZG93biB0byB0aGlzIG1pbmltdW0gc2l6ZVxuXHRcdFx0YmlnRml4ZWRSYXRpbzogZmFsc2UsIC8vIGZpeGVkUmF0aW8gZm9yIHRoZSBiaWcgb25lc1xuXHRcdFx0YmlnTWF4UmF0aW86IDkgLyAxNiwgLy8gVGhlIG5hcnJvd2VzdCByYXRpbyB0byB1c2UgZm9yIHRoZSBiaWcgZWxlbWVudHMgKGRlZmF1bHQgMngzKVxuXHRcdFx0YmlnTWluUmF0aW86IDkgLyAxNiwgLy8gVGhlIHdpZGVzdCByYXRpbyB0byB1c2UgZm9yIHRoZSBiaWcgZWxlbWVudHMgKGRlZmF1bHQgMTZ4OSlcblx0XHRcdGJpZ0ZpcnN0OiB0cnVlLCAvLyBXaGV0aGVyIHRvIHBsYWNlIHRoZSBiaWcgb25lIGluIHRoZSB0b3AgbGVmdCAodHJ1ZSkgb3IgYm90dG9tIHJpZ2h0XG5cdFx0XHRhbmltYXRlOiB0cnVlLCAvLyBXaGV0aGVyIHlvdSB3YW50IHRvIGFuaW1hdGUgdGhlIHRyYW5zaXRpb25zLiBEZXByZWNhdGVkIHByb3BlcnR5LCB0byBkaXNhYmxlIGl0IHJlbW92ZSB0aGUgdHJhbnNhY3Rpb24gcHJvcGVydHkgb24gT1RfcHVibGlzaGVyIGNzcyBjbGFzc1xuXHRcdFx0YWxpZ25JdGVtczogTGF5b3V0QWxpZ25tZW50LkNFTlRFUixcblx0XHRcdGJpZ0FsaWduSXRlbXM6IExheW91dEFsaWdubWVudC5DRU5URVIsXG5cdFx0XHRzbWFsbEFsaWduSXRlbXM6IExheW91dEFsaWdubWVudC5DRU5URVIsXG5cdFx0XHRtYXhXaWR0aDogSW5maW5pdHksIC8vIFRoZSBtYXhpbXVtIHdpZHRoIG9mIHRoZSBlbGVtZW50c1xuXHRcdFx0bWF4SGVpZ2h0OiBJbmZpbml0eSwgLy8gVGhlIG1heGltdW0gaGVpZ2h0IG9mIHRoZSBlbGVtZW50c1xuXHRcdFx0c21hbGxNYXhXaWR0aDogSW5maW5pdHksXG5cdFx0XHRzbWFsbE1heEhlaWdodDogSW5maW5pdHksXG5cdFx0XHRiaWdNYXhXaWR0aDogSW5maW5pdHksXG5cdFx0XHRiaWdNYXhIZWlnaHQ6IEluZmluaXR5LFxuXHRcdFx0c2NhbGVMYXN0Um93OiB0cnVlLFxuXHRcdFx0YmlnU2NhbGVMYXN0Um93OiB0cnVlXG5cdFx0fTtcblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fVxuXG5cdHRvZ2dsZUNhcHRpb25zKCkge1xuXHRcdHRoaXMuY2FwdGlvbnNUb2dnbGluZy5uZXh0KCF0aGlzLmNhcHRpb25zVG9nZ2xpbmcuZ2V0VmFsdWUoKSk7XG5cdH1cblxuXHR1cGRhdGUodGltZW91dDogbnVtYmVyID0gbnVsbCkge1xuXHRcdGNvbnN0IHVwZGF0ZUF1eCA9ICgpID0+IHtcblx0XHRcdGlmICghIXRoaXMub3BlbnZpZHVMYXlvdXQpIHtcblx0XHRcdFx0dGhpcy5vcGVudmlkdUxheW91dC51cGRhdGVMYXlvdXQodGhpcy5sYXlvdXRDb250YWluZXIsIHRoaXMub3BlbnZpZHVMYXlvdXRPcHRpb25zKTtcblx0XHRcdFx0dGhpcy5zZW5kTGF5b3V0V2lkdGhFdmVudCgpO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0aWYgKHR5cGVvZiB0aW1lb3V0ID09PSAnbnVtYmVyJyAmJiB0aW1lb3V0ID49IDApIHtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdXBkYXRlQXV4KCksIHRpbWVvdXQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR1cGRhdGVBdXgoKTtcblx0XHR9XG5cdH1cblxuXHRnZXRMYXlvdXQoKSB7XG5cdFx0cmV0dXJuIHRoaXMub3BlbnZpZHVMYXlvdXQ7XG5cdH1cblxuXHRjbGVhcigpIHtcblx0XHR0aGlzLm9wZW52aWR1TGF5b3V0ID0gbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgc2VuZExheW91dFdpZHRoRXZlbnQoKSB7XG5cdFx0Y29uc3Qgc2lkZW5hdkxheW91dEVsZW1lbnQgPSB0aGlzLmdldEhUTUxFbGVtZW50QnlDbGFzc05hbWUoXG5cdFx0XHR0aGlzLm9wZW52aWR1TGF5b3V0Py5nZXRMYXlvdXRDb250YWluZXIoKSxcblx0XHRcdExheW91dENsYXNzLlNJREVOQVZfQ09OVEFJTkVSXG5cdFx0KTtcblx0XHRpZiAoc2lkZW5hdkxheW91dEVsZW1lbnQgJiYgc2lkZW5hdkxheW91dEVsZW1lbnQuY2xpZW50V2lkdGgpIHtcblx0XHRcdHRoaXMubGF5b3V0V2lkdGgubmV4dChzaWRlbmF2TGF5b3V0RWxlbWVudC5jbGllbnRXaWR0aCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBnZXRIVE1MRWxlbWVudEJ5Q2xhc3NOYW1lKGVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgbnVsbCwgY2xhc3NOYW1lOiBzdHJpbmcpOiBIVE1MRWxlbWVudCB8IG51bGwge1xuXHRcdHdoaWxlICghIWVsZW1lbnQgJiYgZWxlbWVudCAhPT0gZG9jdW1lbnQuYm9keSkge1xuXHRcdFx0aWYgKGVsZW1lbnQuY2xhc3NOYW1lLmluY2x1ZGVzKGNsYXNzTmFtZSkpIHtcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQ7XG5cdFx0XHR9XG5cdFx0XHRlbGVtZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxufVxuIl19