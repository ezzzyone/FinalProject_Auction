import { ChangeDetectionStrategy, Component, ViewChild } from '@angular/core';
import { PanelType } from '../../../models/panel.model';
import * as i0 from "@angular/core";
import * as i1 from "../../../services/chat/chat.service";
import * as i2 from "../../../services/panel/panel.service";
import * as i3 from "@angular/common";
import * as i4 from "@angular/forms";
import * as i5 from "@angular/material/button";
import * as i6 from "@angular/material/icon";
import * as i7 from "@angular/material/tooltip";
import * as i8 from "@angular/flex-layout/flex";
import * as i9 from "@angular/flex-layout/extended";
import * as i10 from "../../../pipes/linkify.pipe";
import * as i11 from "../../../pipes/translate.pipe";
/**
 *
 * The **ChatPanelComponent** is hosted inside of the {@link PanelComponent}.
 * It is in charge of displaying the session chat.
 *
 * <div class="custom-table-container">

 * <div>
 *
 * <h3>OpenVidu Angular Directives</h3>
 *
 * The ChatPanelComponent can be replaced with a custom component. It provides us the following {@link https://angular.io/guide/structural-directives Angular structural directives}
 * for doing this.
 *
 * |            **Directive**           |                 **Reference**                 |
 * |:----------------------------------:|:---------------------------------------------:|
 * |           ***ovChatPanel**          |           {@link ChatPanelDirective}          |
 *
 * <p class="component-link-text">
 * 	<span class="italic">See all {@link OpenViduAngularDirectiveModule OpenVidu Angular Directives}</span>
 * </p>
 * </div>
 * </div>
 */
export class ChatPanelComponent {
    /**
     * @ignore
     */
    constructor(chatService, panelService, cd) {
        this.chatService = chatService;
        this.panelService = panelService;
        this.cd = cd;
        this.messageList = [];
    }
    ngOnInit() {
        this.subscribeToMessages();
    }
    ngAfterViewInit() {
        setTimeout(() => {
            this.scrollToBottom();
            this.chatInput.nativeElement.focus();
        }, 100);
    }
    ngOnDestroy() {
        if (this.chatMessageSubscription)
            this.chatMessageSubscription.unsubscribe();
    }
    /**
     * @ignore
     */
    eventKeyPress(event) {
        // Pressed 'Enter' key
        if (event && event.keyCode === 13) {
            event.preventDefault();
            this.sendMessage();
        }
    }
    sendMessage() {
        if (!!this.message) {
            this.chatService.sendMessage(this.message);
            this.message = '';
        }
    }
    scrollToBottom() {
        setTimeout(() => {
            try {
                this.chatScroll.nativeElement.scrollTop = this.chatScroll.nativeElement.scrollHeight;
            }
            catch (err) { }
        }, 20);
    }
    close() {
        this.panelService.togglePanel(PanelType.CHAT);
    }
    subscribeToMessages() {
        this.chatMessageSubscription = this.chatService.messagesObs.subscribe((messages) => {
            this.messageList = messages;
            if (this.panelService.isChatPanelOpened()) {
                this.scrollToBottom();
                this.cd.markForCheck();
            }
        });
    }
}
ChatPanelComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: ChatPanelComponent, deps: [{ token: i1.ChatService }, { token: i2.PanelService }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
ChatPanelComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.8", type: ChatPanelComponent, selector: "ov-chat-panel", viewQueries: [{ propertyName: "chatScroll", first: true, predicate: ["chatScroll"], descendants: true }, { propertyName: "chatInput", first: true, predicate: ["chatInput"], descendants: true }], ngImport: i0, template: "<div class=\"panel-container\" id=\"chat-container\" fxLayout=\"column\" fxLayoutAlign=\"space-evenly none\" >\n\t<div class=\"panel-header-container\" fxFlex=\"55px\" fxLayoutAlign=\"start center\">\n\t\t<h3 class=\"panel-title\">{{ 'PANEL.CHAT.TITLE' | translate }}</h3>\n\t\t<button class=\"panel-close-button\" mat-icon-button matTooltip=\"{{ 'PANEL.CLOSE' | translate }}\" (click)=\"close()\">\n\t\t\t<mat-icon>close</mat-icon>\n\t\t</button>\n\t</div>\n\n\t<div class=\"text-container\" fxFlex=\"20px\">\n\t\t<p class=\"text-info\">{{ 'PANEL.CHAT.SUBTITLE' | translate }}</p>\n\t</div>\n\n\t<div class=\"messages-container\" fxFlex=\"75%\" fxLayoutAlign=\"space-evenly none\" #chatScroll>\n\t\t<div *ngFor=\"let data of messageList\" class=\"message\" [ngClass]=\"data.isLocal ? 'right' : 'left'\">\n\t\t\t<div class=\"msg-detail\">\n\t\t\t\t<div class=\"nickname-container\">\n\t\t\t\t\t<p *ngIf=\"data.isLocal\">{{ 'PANEL.CHAT.YOU' | translate }}</p>\n\t\t\t\t\t<p *ngIf=\"!data.isLocal\">{{ data.nickname }}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"msg-content\">\n\t\t\t\t\t<p [innerHTML]=\"data.message | linkify\"></p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"input-container\" fxFlex=\"55px\" fxFlexOrder=\"3\" fxLayoutAlign=\"space-evenly none\">\n\t\t<textarea\n\t\t\t#chatInput\n\t\t\tmaxlength=\"500\"\n\t\t\trows=\"4\"\n\t\t\tplaceholder=\"{{ 'PANEL.CHAT.PLACEHOLDER' | translate }}\"\n\t\t\tautocomplete=\"off\"\n\t\t\t(keypress)=\"eventKeyPress($event)\"\n\t\t\t[(ngModel)]=\"message\"\n\t\t\tid=\"chat-input\"\n\t\t></textarea>\n\t\t<button mat-icon-button id=\"send-btn\" (click)=\"sendMessage()\">\n\t\t\t<mat-icon matTooltip=\"{{ 'PANEL.CHAT.SEND' | translate }}\">send</mat-icon>\n\t\t</button>\n\t</div>\n</div>\n", styles: [".panel-container{margin:20px;background-color:var(--ov-panel-background);border-radius:var(--ov-panel-radius);max-height:calc(100% - 40px);min-height:calc(100% - 40px)}.panel-header-container{padding:10px;display:flex}.panel-title{margin-left:5px;margin-top:auto;margin-bottom:auto}.panel-close-button{margin-left:auto;border-radius:var(--ov-buttons-radius)}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-thumb{background:#a7a7a7;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#7c7c7c}::-webkit-scrollbar-track{background:var(--ov-light-color);border-radius:4px}\n", ".text-container{background-color:var(--ov-light-color);color:var(--ov-panel-text-color);text-align:center;font-size:12px}.text-info{margin:3px}.messages-container{display:block!important;overflow-y:auto;overflow-x:hidden;padding:10px}.input-container{height:25px;display:flex;background-color:var(--ov-light-color);padding:10px;margin:10px;border-radius:var(--ov-panel-radius)}.input-container textarea{width:100%;height:16px;margin:auto;background-color:transparent;display:block;border:none;padding:0;word-wrap:break-word;white-space:pre-wrap;resize:none;outline:none;box-shadow:none;font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif}.message{position:relative;padding:3px 0}.msg-detail{width:95%;display:inline-block}.msg-detail p{margin:0;font-size:14px}.nickname-container p{font-size:13px;font-weight:700;color:var(--ov-panel-text-color)}.msg-content{position:relative;border-radius:var(--ov-panel-radius);padding:8px;color:#000;width:auto;max-width:95%;font-size:13px;word-break:break-all}#send-btn{border-radius:var(--ov-buttons-radius)}.message.left .msg-detail .nickname-container{text-align:left}.message.left .msg-detail .msg-content{float:left}.message.right .msg-detail .nickname-container{text-align:right}.message.right .msg-detail .msg-content{float:right}::ng-deep a:-webkit-any-link{color:#1a73e8}\n"], dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i4.MaxLengthValidator, selector: "[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]", inputs: ["maxlength"] }, { kind: "directive", type: i4.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "component", type: i5.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }, { kind: "component", type: i6.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "directive", type: i7.MatTooltip, selector: "[matTooltip]", exportAs: ["matTooltip"] }, { kind: "directive", type: i8.DefaultLayoutDirective, selector: "  [fxLayout], [fxLayout.xs], [fxLayout.sm], [fxLayout.md],  [fxLayout.lg], [fxLayout.xl], [fxLayout.lt-sm], [fxLayout.lt-md],  [fxLayout.lt-lg], [fxLayout.lt-xl], [fxLayout.gt-xs], [fxLayout.gt-sm],  [fxLayout.gt-md], [fxLayout.gt-lg]", inputs: ["fxLayout", "fxLayout.xs", "fxLayout.sm", "fxLayout.md", "fxLayout.lg", "fxLayout.xl", "fxLayout.lt-sm", "fxLayout.lt-md", "fxLayout.lt-lg", "fxLayout.lt-xl", "fxLayout.gt-xs", "fxLayout.gt-sm", "fxLayout.gt-md", "fxLayout.gt-lg"] }, { kind: "directive", type: i8.DefaultLayoutAlignDirective, selector: "  [fxLayoutAlign], [fxLayoutAlign.xs], [fxLayoutAlign.sm], [fxLayoutAlign.md],  [fxLayoutAlign.lg], [fxLayoutAlign.xl], [fxLayoutAlign.lt-sm], [fxLayoutAlign.lt-md],  [fxLayoutAlign.lt-lg], [fxLayoutAlign.lt-xl], [fxLayoutAlign.gt-xs], [fxLayoutAlign.gt-sm],  [fxLayoutAlign.gt-md], [fxLayoutAlign.gt-lg]", inputs: ["fxLayoutAlign", "fxLayoutAlign.xs", "fxLayoutAlign.sm", "fxLayoutAlign.md", "fxLayoutAlign.lg", "fxLayoutAlign.xl", "fxLayoutAlign.lt-sm", "fxLayoutAlign.lt-md", "fxLayoutAlign.lt-lg", "fxLayoutAlign.lt-xl", "fxLayoutAlign.gt-xs", "fxLayoutAlign.gt-sm", "fxLayoutAlign.gt-md", "fxLayoutAlign.gt-lg"] }, { kind: "directive", type: i8.DefaultFlexOrderDirective, selector: "  [fxFlexOrder], [fxFlexOrder.xs], [fxFlexOrder.sm], [fxFlexOrder.md],  [fxFlexOrder.lg], [fxFlexOrder.xl], [fxFlexOrder.lt-sm], [fxFlexOrder.lt-md],  [fxFlexOrder.lt-lg], [fxFlexOrder.lt-xl], [fxFlexOrder.gt-xs], [fxFlexOrder.gt-sm],  [fxFlexOrder.gt-md], [fxFlexOrder.gt-lg]", inputs: ["fxFlexOrder", "fxFlexOrder.xs", "fxFlexOrder.sm", "fxFlexOrder.md", "fxFlexOrder.lg", "fxFlexOrder.xl", "fxFlexOrder.lt-sm", "fxFlexOrder.lt-md", "fxFlexOrder.lt-lg", "fxFlexOrder.lt-xl", "fxFlexOrder.gt-xs", "fxFlexOrder.gt-sm", "fxFlexOrder.gt-md", "fxFlexOrder.gt-lg"] }, { kind: "directive", type: i8.DefaultFlexDirective, selector: "  [fxFlex], [fxFlex.xs], [fxFlex.sm], [fxFlex.md],  [fxFlex.lg], [fxFlex.xl], [fxFlex.lt-sm], [fxFlex.lt-md],  [fxFlex.lt-lg], [fxFlex.lt-xl], [fxFlex.gt-xs], [fxFlex.gt-sm],  [fxFlex.gt-md], [fxFlex.gt-lg]", inputs: ["fxFlex", "fxFlex.xs", "fxFlex.sm", "fxFlex.md", "fxFlex.lg", "fxFlex.xl", "fxFlex.lt-sm", "fxFlex.lt-md", "fxFlex.lt-lg", "fxFlex.lt-xl", "fxFlex.gt-xs", "fxFlex.gt-sm", "fxFlex.gt-md", "fxFlex.gt-lg"] }, { kind: "directive", type: i9.DefaultClassDirective, selector: "  [ngClass], [ngClass.xs], [ngClass.sm], [ngClass.md], [ngClass.lg], [ngClass.xl],  [ngClass.lt-sm], [ngClass.lt-md], [ngClass.lt-lg], [ngClass.lt-xl],  [ngClass.gt-xs], [ngClass.gt-sm], [ngClass.gt-md], [ngClass.gt-lg]", inputs: ["ngClass", "ngClass.xs", "ngClass.sm", "ngClass.md", "ngClass.lg", "ngClass.xl", "ngClass.lt-sm", "ngClass.lt-md", "ngClass.lt-lg", "ngClass.lt-xl", "ngClass.gt-xs", "ngClass.gt-sm", "ngClass.gt-md", "ngClass.gt-lg"] }, { kind: "pipe", type: i10.LinkifyPipe, name: "linkify" }, { kind: "pipe", type: i11.TranslatePipe, name: "translate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.8", ngImport: i0, type: ChatPanelComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ov-chat-panel', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div class=\"panel-container\" id=\"chat-container\" fxLayout=\"column\" fxLayoutAlign=\"space-evenly none\" >\n\t<div class=\"panel-header-container\" fxFlex=\"55px\" fxLayoutAlign=\"start center\">\n\t\t<h3 class=\"panel-title\">{{ 'PANEL.CHAT.TITLE' | translate }}</h3>\n\t\t<button class=\"panel-close-button\" mat-icon-button matTooltip=\"{{ 'PANEL.CLOSE' | translate }}\" (click)=\"close()\">\n\t\t\t<mat-icon>close</mat-icon>\n\t\t</button>\n\t</div>\n\n\t<div class=\"text-container\" fxFlex=\"20px\">\n\t\t<p class=\"text-info\">{{ 'PANEL.CHAT.SUBTITLE' | translate }}</p>\n\t</div>\n\n\t<div class=\"messages-container\" fxFlex=\"75%\" fxLayoutAlign=\"space-evenly none\" #chatScroll>\n\t\t<div *ngFor=\"let data of messageList\" class=\"message\" [ngClass]=\"data.isLocal ? 'right' : 'left'\">\n\t\t\t<div class=\"msg-detail\">\n\t\t\t\t<div class=\"nickname-container\">\n\t\t\t\t\t<p *ngIf=\"data.isLocal\">{{ 'PANEL.CHAT.YOU' | translate }}</p>\n\t\t\t\t\t<p *ngIf=\"!data.isLocal\">{{ data.nickname }}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"msg-content\">\n\t\t\t\t\t<p [innerHTML]=\"data.message | linkify\"></p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"input-container\" fxFlex=\"55px\" fxFlexOrder=\"3\" fxLayoutAlign=\"space-evenly none\">\n\t\t<textarea\n\t\t\t#chatInput\n\t\t\tmaxlength=\"500\"\n\t\t\trows=\"4\"\n\t\t\tplaceholder=\"{{ 'PANEL.CHAT.PLACEHOLDER' | translate }}\"\n\t\t\tautocomplete=\"off\"\n\t\t\t(keypress)=\"eventKeyPress($event)\"\n\t\t\t[(ngModel)]=\"message\"\n\t\t\tid=\"chat-input\"\n\t\t></textarea>\n\t\t<button mat-icon-button id=\"send-btn\" (click)=\"sendMessage()\">\n\t\t\t<mat-icon matTooltip=\"{{ 'PANEL.CHAT.SEND' | translate }}\">send</mat-icon>\n\t\t</button>\n\t</div>\n</div>\n", styles: [".panel-container{margin:20px;background-color:var(--ov-panel-background);border-radius:var(--ov-panel-radius);max-height:calc(100% - 40px);min-height:calc(100% - 40px)}.panel-header-container{padding:10px;display:flex}.panel-title{margin-left:5px;margin-top:auto;margin-bottom:auto}.panel-close-button{margin-left:auto;border-radius:var(--ov-buttons-radius)}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-thumb{background:#a7a7a7;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#7c7c7c}::-webkit-scrollbar-track{background:var(--ov-light-color);border-radius:4px}\n", ".text-container{background-color:var(--ov-light-color);color:var(--ov-panel-text-color);text-align:center;font-size:12px}.text-info{margin:3px}.messages-container{display:block!important;overflow-y:auto;overflow-x:hidden;padding:10px}.input-container{height:25px;display:flex;background-color:var(--ov-light-color);padding:10px;margin:10px;border-radius:var(--ov-panel-radius)}.input-container textarea{width:100%;height:16px;margin:auto;background-color:transparent;display:block;border:none;padding:0;word-wrap:break-word;white-space:pre-wrap;resize:none;outline:none;box-shadow:none;font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif}.message{position:relative;padding:3px 0}.msg-detail{width:95%;display:inline-block}.msg-detail p{margin:0;font-size:14px}.nickname-container p{font-size:13px;font-weight:700;color:var(--ov-panel-text-color)}.msg-content{position:relative;border-radius:var(--ov-panel-radius);padding:8px;color:#000;width:auto;max-width:95%;font-size:13px;word-break:break-all}#send-btn{border-radius:var(--ov-buttons-radius)}.message.left .msg-detail .nickname-container{text-align:left}.message.left .msg-detail .msg-content{float:left}.message.right .msg-detail .nickname-container{text-align:right}.message.right .msg-detail .msg-content{float:right}::ng-deep a:-webkit-any-link{color:#1a73e8}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.ChatService }, { type: i2.PanelService }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { chatScroll: [{
                type: ViewChild,
                args: ['chatScroll']
            }], chatInput: [{
                type: ViewChild,
                args: ['chatInput']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhdC1wYW5lbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9vcGVudmlkdS1hbmd1bGFyL3NyYy9saWIvY29tcG9uZW50cy9wYW5lbC9jaGF0LXBhbmVsL2NoYXQtcGFuZWwuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvb3BlbnZpZHUtYW5ndWxhci9zcmMvbGliL2NvbXBvbmVudHMvcGFuZWwvY2hhdC1wYW5lbC9jaGF0LXBhbmVsLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTix1QkFBdUIsRUFFdkIsU0FBUyxFQUlULFNBQVMsRUFDVCxNQUFNLGVBQWUsQ0FBQztBQUd2QixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7Ozs7Ozs7Ozs7Ozs7QUFJeEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBdUJHO0FBT0gsTUFBTSxPQUFPLGtCQUFrQjtJQWtCOUI7O09BRUc7SUFDSCxZQUFvQixXQUF3QixFQUFVLFlBQTBCLEVBQVUsRUFBcUI7UUFBM0YsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFBVSxpQkFBWSxHQUFaLFlBQVksQ0FBYztRQUFVLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBUC9HLGdCQUFXLEdBQWtCLEVBQUUsQ0FBQztJQU9rRixDQUFDO0lBRW5ILFFBQVE7UUFDUCxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQsZUFBZTtRQUNkLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDZixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdEMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ1QsQ0FBQztJQUVELFdBQVc7UUFDVixJQUFJLElBQUksQ0FBQyx1QkFBdUI7WUFBRSxJQUFJLENBQUMsdUJBQXVCLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDOUUsQ0FBQztJQUVEOztPQUVHO0lBQ0gsYUFBYSxDQUFDLEtBQUs7UUFDbEIsc0JBQXNCO1FBQ3RCLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxPQUFPLEtBQUssRUFBRSxFQUFFO1lBQ2xDLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUN2QixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDbkI7SUFDRixDQUFDO0lBRUQsV0FBVztRQUNWLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDbkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzNDLElBQUksQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1NBQ2xCO0lBQ0YsQ0FBQztJQUVELGNBQWM7UUFDYixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2YsSUFBSTtnQkFDSCxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDO2FBQ3JGO1lBQUMsT0FBTyxHQUFHLEVBQUUsR0FBRTtRQUNqQixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDUixDQUFDO0lBRUQsS0FBSztRQUNKLElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRU8sbUJBQW1CO1FBQzFCLElBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxRQUF1QixFQUFFLEVBQUU7WUFDakcsSUFBSSxDQUFDLFdBQVcsR0FBRyxRQUFRLENBQUM7WUFDNUIsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLGlCQUFpQixFQUFFLEVBQUU7Z0JBQzFDLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztnQkFDdEIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQzthQUN2QjtRQUNGLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQzs7K0dBNUVXLGtCQUFrQjttR0FBbEIsa0JBQWtCLHdQQzlDL0IsMnVEQTBDQTsyRkRJYSxrQkFBa0I7a0JBTjlCLFNBQVM7K0JBQ0MsZUFBZSxtQkFHUix1QkFBdUIsQ0FBQyxNQUFNOzZKQU10QixVQUFVO3NCQUFsQyxTQUFTO3VCQUFDLFlBQVk7Z0JBSUMsU0FBUztzQkFBaEMsU0FBUzt1QkFBQyxXQUFXIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcblx0QWZ0ZXJWaWV3SW5pdCxcblx0Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG5cdENoYW5nZURldGVjdG9yUmVmLFxuXHRDb21wb25lbnQsXG5cdEVsZW1lbnRSZWYsXG5cdEhvc3RMaXN0ZW5lcixcblx0T25Jbml0LFxuXHRWaWV3Q2hpbGRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IENoYXRNZXNzYWdlIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL2NoYXQubW9kZWwnO1xuaW1wb3J0IHsgUGFuZWxUeXBlIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL3BhbmVsLm1vZGVsJztcbmltcG9ydCB7IENoYXRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvY2hhdC9jaGF0LnNlcnZpY2UnO1xuaW1wb3J0IHsgUGFuZWxTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvcGFuZWwvcGFuZWwuc2VydmljZSc7XG5cbi8qKlxuICpcbiAqIFRoZSAqKkNoYXRQYW5lbENvbXBvbmVudCoqIGlzIGhvc3RlZCBpbnNpZGUgb2YgdGhlIHtAbGluayBQYW5lbENvbXBvbmVudH0uXG4gKiBJdCBpcyBpbiBjaGFyZ2Ugb2YgZGlzcGxheWluZyB0aGUgc2Vzc2lvbiBjaGF0LlxuICpcbiAqIDxkaXYgY2xhc3M9XCJjdXN0b20tdGFibGUtY29udGFpbmVyXCI+XG5cbiAqIDxkaXY+XG4gKlxuICogPGgzPk9wZW5WaWR1IEFuZ3VsYXIgRGlyZWN0aXZlczwvaDM+XG4gKlxuICogVGhlIENoYXRQYW5lbENvbXBvbmVudCBjYW4gYmUgcmVwbGFjZWQgd2l0aCBhIGN1c3RvbSBjb21wb25lbnQuIEl0IHByb3ZpZGVzIHVzIHRoZSBmb2xsb3dpbmcge0BsaW5rIGh0dHBzOi8vYW5ndWxhci5pby9ndWlkZS9zdHJ1Y3R1cmFsLWRpcmVjdGl2ZXMgQW5ndWxhciBzdHJ1Y3R1cmFsIGRpcmVjdGl2ZXN9XG4gKiBmb3IgZG9pbmcgdGhpcy5cbiAqXG4gKiB8ICAgICAgICAgICAgKipEaXJlY3RpdmUqKiAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgKipSZWZlcmVuY2UqKiAgICAgICAgICAgICAgICAgfFxuICogfDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tOnw6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tOnxcbiAqIHwgICAgICAgICAgICoqKm92Q2hhdFBhbmVsKiogICAgICAgICAgfCAgICAgICAgICAge0BsaW5rIENoYXRQYW5lbERpcmVjdGl2ZX0gICAgICAgICAgfFxuICpcbiAqIDxwIGNsYXNzPVwiY29tcG9uZW50LWxpbmstdGV4dFwiPlxuICogXHQ8c3BhbiBjbGFzcz1cIml0YWxpY1wiPlNlZSBhbGwge0BsaW5rIE9wZW5WaWR1QW5ndWxhckRpcmVjdGl2ZU1vZHVsZSBPcGVuVmlkdSBBbmd1bGFyIERpcmVjdGl2ZXN9PC9zcGFuPlxuICogPC9wPlxuICogPC9kaXY+XG4gKiA8L2Rpdj5cbiAqL1xuQENvbXBvbmVudCh7XG5cdHNlbGVjdG9yOiAnb3YtY2hhdC1wYW5lbCcsXG5cdHRlbXBsYXRlVXJsOiAnLi9jaGF0LXBhbmVsLmNvbXBvbmVudC5odG1sJyxcblx0c3R5bGVVcmxzOiBbJy4uL3BhbmVsLmNvbXBvbmVudC5jc3MnLCcuL2NoYXQtcGFuZWwuY29tcG9uZW50LmNzcyddLFxuXHRjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBDaGF0UGFuZWxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQge1xuXHQvKipcblx0ICogQGlnbm9yZVxuXHQgKi9cblx0QFZpZXdDaGlsZCgnY2hhdFNjcm9sbCcpIGNoYXRTY3JvbGw6IEVsZW1lbnRSZWY7XG5cdC8qKlxuXHQgKiBAaWdub3JlXG5cdCAqL1xuXHRAVmlld0NoaWxkKCdjaGF0SW5wdXQnKSBjaGF0SW5wdXQ6IEVsZW1lbnRSZWY7XG5cdC8qKlxuXHQgKiBAaWdub3JlXG5cdCAqL1xuXHRtZXNzYWdlOiBzdHJpbmc7XG5cblx0bWVzc2FnZUxpc3Q6IENoYXRNZXNzYWdlW10gPSBbXTtcblxuXHRwcml2YXRlIGNoYXRNZXNzYWdlU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cblx0LyoqXG5cdCAqIEBpZ25vcmVcblx0ICovXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgY2hhdFNlcnZpY2U6IENoYXRTZXJ2aWNlLCBwcml2YXRlIHBhbmVsU2VydmljZTogUGFuZWxTZXJ2aWNlLCBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikge31cblxuXHRuZ09uSW5pdCgpIHtcblx0XHR0aGlzLnN1YnNjcmliZVRvTWVzc2FnZXMoKTtcblx0fVxuXG5cdG5nQWZ0ZXJWaWV3SW5pdCgpIHtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTtcblx0XHRcdHRoaXMuY2hhdElucHV0Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcblx0XHR9LCAxMDApO1xuXHR9XG5cblx0bmdPbkRlc3Ryb3koKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY2hhdE1lc3NhZ2VTdWJzY3JpcHRpb24pIHRoaXMuY2hhdE1lc3NhZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAaWdub3JlXG5cdCAqL1xuXHRldmVudEtleVByZXNzKGV2ZW50KSB7XG5cdFx0Ly8gUHJlc3NlZCAnRW50ZXInIGtleVxuXHRcdGlmIChldmVudCAmJiBldmVudC5rZXlDb2RlID09PSAxMykge1xuXHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMuc2VuZE1lc3NhZ2UoKTtcblx0XHR9XG5cdH1cblxuXHRzZW5kTWVzc2FnZSgpOiB2b2lkIHtcblx0XHRpZiAoISF0aGlzLm1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY2hhdFNlcnZpY2Uuc2VuZE1lc3NhZ2UodGhpcy5tZXNzYWdlKTtcblx0XHRcdHRoaXMubWVzc2FnZSA9ICcnO1xuXHRcdH1cblx0fVxuXG5cdHNjcm9sbFRvQm90dG9tKCk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dGhpcy5jaGF0U2Nyb2xsLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy5jaGF0U2Nyb2xsLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0fSBjYXRjaCAoZXJyKSB7fVxuXHRcdH0sIDIwKTtcblx0fVxuXG5cdGNsb3NlKCkge1xuXHRcdHRoaXMucGFuZWxTZXJ2aWNlLnRvZ2dsZVBhbmVsKFBhbmVsVHlwZS5DSEFUKTtcblx0fVxuXG5cdHByaXZhdGUgc3Vic2NyaWJlVG9NZXNzYWdlcygpIHtcblx0XHR0aGlzLmNoYXRNZXNzYWdlU3Vic2NyaXB0aW9uID0gdGhpcy5jaGF0U2VydmljZS5tZXNzYWdlc09icy5zdWJzY3JpYmUoKG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdKSA9PiB7XG5cdFx0XHR0aGlzLm1lc3NhZ2VMaXN0ID0gbWVzc2FnZXM7XG5cdFx0XHRpZiAodGhpcy5wYW5lbFNlcnZpY2UuaXNDaGF0UGFuZWxPcGVuZWQoKSkge1xuXHRcdFx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKCk7XG5cdFx0XHRcdHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJwYW5lbC1jb250YWluZXJcIiBpZD1cImNoYXQtY29udGFpbmVyXCIgZnhMYXlvdXQ9XCJjb2x1bW5cIiBmeExheW91dEFsaWduPVwic3BhY2UtZXZlbmx5IG5vbmVcIiA+XG5cdDxkaXYgY2xhc3M9XCJwYW5lbC1oZWFkZXItY29udGFpbmVyXCIgZnhGbGV4PVwiNTVweFwiIGZ4TGF5b3V0QWxpZ249XCJzdGFydCBjZW50ZXJcIj5cblx0XHQ8aDMgY2xhc3M9XCJwYW5lbC10aXRsZVwiPnt7ICdQQU5FTC5DSEFULlRJVExFJyB8IHRyYW5zbGF0ZSB9fTwvaDM+XG5cdFx0PGJ1dHRvbiBjbGFzcz1cInBhbmVsLWNsb3NlLWJ1dHRvblwiIG1hdC1pY29uLWJ1dHRvbiBtYXRUb29sdGlwPVwie3sgJ1BBTkVMLkNMT1NFJyB8IHRyYW5zbGF0ZSB9fVwiIChjbGljayk9XCJjbG9zZSgpXCI+XG5cdFx0XHQ8bWF0LWljb24+Y2xvc2U8L21hdC1pY29uPlxuXHRcdDwvYnV0dG9uPlxuXHQ8L2Rpdj5cblxuXHQ8ZGl2IGNsYXNzPVwidGV4dC1jb250YWluZXJcIiBmeEZsZXg9XCIyMHB4XCI+XG5cdFx0PHAgY2xhc3M9XCJ0ZXh0LWluZm9cIj57eyAnUEFORUwuQ0hBVC5TVUJUSVRMRScgfCB0cmFuc2xhdGUgfX08L3A+XG5cdDwvZGl2PlxuXG5cdDxkaXYgY2xhc3M9XCJtZXNzYWdlcy1jb250YWluZXJcIiBmeEZsZXg9XCI3NSVcIiBmeExheW91dEFsaWduPVwic3BhY2UtZXZlbmx5IG5vbmVcIiAjY2hhdFNjcm9sbD5cblx0XHQ8ZGl2ICpuZ0Zvcj1cImxldCBkYXRhIG9mIG1lc3NhZ2VMaXN0XCIgY2xhc3M9XCJtZXNzYWdlXCIgW25nQ2xhc3NdPVwiZGF0YS5pc0xvY2FsID8gJ3JpZ2h0JyA6ICdsZWZ0J1wiPlxuXHRcdFx0PGRpdiBjbGFzcz1cIm1zZy1kZXRhaWxcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5pY2tuYW1lLWNvbnRhaW5lclwiPlxuXHRcdFx0XHRcdDxwICpuZ0lmPVwiZGF0YS5pc0xvY2FsXCI+e3sgJ1BBTkVMLkNIQVQuWU9VJyB8IHRyYW5zbGF0ZSB9fTwvcD5cblx0XHRcdFx0XHQ8cCAqbmdJZj1cIiFkYXRhLmlzTG9jYWxcIj57eyBkYXRhLm5pY2tuYW1lIH19PC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1zZy1jb250ZW50XCI+XG5cdFx0XHRcdFx0PHAgW2lubmVySFRNTF09XCJkYXRhLm1lc3NhZ2UgfCBsaW5raWZ5XCI+PC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdDwvZGl2PlxuXHQ8L2Rpdj5cblxuXHQ8ZGl2IGNsYXNzPVwiaW5wdXQtY29udGFpbmVyXCIgZnhGbGV4PVwiNTVweFwiIGZ4RmxleE9yZGVyPVwiM1wiIGZ4TGF5b3V0QWxpZ249XCJzcGFjZS1ldmVubHkgbm9uZVwiPlxuXHRcdDx0ZXh0YXJlYVxuXHRcdFx0I2NoYXRJbnB1dFxuXHRcdFx0bWF4bGVuZ3RoPVwiNTAwXCJcblx0XHRcdHJvd3M9XCI0XCJcblx0XHRcdHBsYWNlaG9sZGVyPVwie3sgJ1BBTkVMLkNIQVQuUExBQ0VIT0xERVInIHwgdHJhbnNsYXRlIH19XCJcblx0XHRcdGF1dG9jb21wbGV0ZT1cIm9mZlwiXG5cdFx0XHQoa2V5cHJlc3MpPVwiZXZlbnRLZXlQcmVzcygkZXZlbnQpXCJcblx0XHRcdFsobmdNb2RlbCldPVwibWVzc2FnZVwiXG5cdFx0XHRpZD1cImNoYXQtaW5wdXRcIlxuXHRcdD48L3RleHRhcmVhPlxuXHRcdDxidXR0b24gbWF0LWljb24tYnV0dG9uIGlkPVwic2VuZC1idG5cIiAoY2xpY2spPVwic2VuZE1lc3NhZ2UoKVwiPlxuXHRcdFx0PG1hdC1pY29uIG1hdFRvb2x0aXA9XCJ7eyAnUEFORUwuQ0hBVC5TRU5EJyB8IHRyYW5zbGF0ZSB9fVwiPnNlbmQ8L21hdC1pY29uPlxuXHRcdDwvYnV0dG9uPlxuXHQ8L2Rpdj5cbjwvZGl2PlxuIl19